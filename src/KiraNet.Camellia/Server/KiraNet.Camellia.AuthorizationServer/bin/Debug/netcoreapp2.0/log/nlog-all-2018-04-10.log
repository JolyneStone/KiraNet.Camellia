2018-04-10 23:04:15.5102|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:04:16.4529|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:04:17.4281|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:04:17.9590|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:04:18.1760|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:04:22.3464|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:04:23.6093|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:04:24.3897|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:04:25.2688|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:04:27.3638|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:04:44.6511|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:04:53.2041|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/css/site.css   
2018-04-10 23:04:53.3917|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery/dist/jquery.js   
2018-04-10 23:04:53.5821|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /css/site.css was not modified 
2018-04-10 23:04:53.6907|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 25313.7758ms 
2018-04-10 23:04:54.0345|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 30600.5393ms 200 text/html; charset=utf-8 
2018-04-10 23:04:54.4545|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/images/Butterfly.png   
2018-04-10 23:04:54.8073|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 781.1939ms 304 text/css 
2018-04-10 23:04:54.9434|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /lib/jquery/dist/jquery.js was not modified 
2018-04-10 23:04:55.1599|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /images/Butterfly.png was not modified 
2018-04-10 23:04:55.2991|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA   
2018-04-10 23:04:55.7619|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1254.3203ms 304 image/png 
2018-04-10 23:04:55.8681|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/tether/dist/js/tether.js   
2018-04-10 23:04:56.0586|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2071.3626ms 304 application/javascript 
2018-04-10 23:04:56.1033|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /js/site.js was not modified 
2018-04-10 23:04:56.3602|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /lib/tether/dist/js/tether.js was not modified 
2018-04-10 23:04:56.6917|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 974.7783ms 304 application/javascript 
2018-04-10 23:04:56.8208|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 965.3841ms 304 application/javascript 
2018-04-10 23:05:05.6048|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/Account/Login   
2018-04-10 23:05:07.2573|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:05:09.6037|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:05:13.9650|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments () - ModelState is Valid 
2018-04-10 23:05:16.0139|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.External signed out. 
2018-04-10 23:05:28.2778|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Account/Login.cshtml. 
2018-04-10 23:05:37.6724|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 25168.9998ms 
2018-04-10 23:05:40.8980|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery-validation/dist/jquery.validate.js   
2018-04-10 23:05:41.4666|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/css/register-login.css   
2018-04-10 23:05:43.1469|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js   
2018-04-10 23:05:44.9295|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/font-awesome/css/font-awesome.min.css   
2018-04-10 23:05:46.4608|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /lib/jquery-validation/dist/jquery.validate.js was not modified 
2018-04-10 23:05:47.3427|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /css/register-login.css was not modified 
2018-04-10 23:05:47.8958|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js was not modified 
2018-04-10 23:05:50.7258|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 34241.5185ms 200 text/html; charset=utf-8 
2018-04-10 23:05:51.2524|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 9473.2723ms 304 application/javascript 
2018-04-10 23:05:52.0886|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 10688.125ms 304 text/css 
2018-04-10 23:05:52.5070|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 11267.0076ms 304 application/javascript 
2018-04-10 23:05:53.8733|6|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|The file /lib/font-awesome/css/font-awesome.min.css was not modified 
2018-04-10 23:05:56.0306|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 16776.9025ms 304 text/css 
2018-04-10 23:06:28.4684|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 POST http://localhost:5000/Account/Login application/x-www-form-urlencoded 232 
2018-04-10 23:06:28.5360|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:06:28.5850|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:06:28.9010|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments (KiraNet.Camellia.AuthorizationServer.Models.ViewModels.LoginViewModel, ) - ModelState is Valid 
2018-04-10 23:06:29.2126|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:06:29.7137|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (365ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Alias], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0 
2018-04-10 23:06:30.2331|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (57ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:06:30.4949|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (71ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:06:30.5655|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:06:30.6928|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (24ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:06:30.7683|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:06:30.8366|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding idp claim with value: local 
2018-04-10 23:06:30.8836|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding amr claim with value: pwd 
2018-04-10 23:06:30.9373|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding auth_time claim with value: 1523372790 
2018-04-10 23:06:30.9964|7|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|Identity.Application was not authenticated. Failure message: Unprotect ticket failed 
2018-04-10 23:06:31.0576|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:06:31.0913|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|User logged in. 
2018-04-10 23:06:31.1622|1|Microsoft.AspNetCore.Mvc.RedirectToActionResult|INFO|Executing RedirectResult, redirecting to /. 
2018-04-10 23:06:31.2551|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 2507.9033ms 
2018-04-10 23:06:31.3098|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2819.5108ms 302  
2018-04-10 23:06:31.3593|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:06:31.4086|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:31.4423|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:31.4793|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:06:31.5194|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:06:31.8417|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 102.2967ms 
2018-04-10 23:06:31.9123|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 515.9997ms 200 text/html; charset=utf-8 
2018-04-10 23:06:35.1280|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/Home/About   
2018-04-10 23:06:35.1746|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:35.2158|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:35.2669|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.About (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:06:36.3341|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/About.cshtml. 
2018-04-10 23:06:36.4104|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:36.4504|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:06:36.5123|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.About (KiraNet.Camellia.AuthorizationServer) in 1226.9544ms 
2018-04-10 23:06:36.7241|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1432.5707ms 200 text/html; charset=utf-8 
2018-04-10 23:07:07.9801|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:07:08.0391|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:07:08.1513|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:07:08.1805|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:07:08.2158|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:07:08.2627|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:07:08.3217|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:07:08.3586|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:07:08.4096|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:07:09.6687|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1625.4792ms 200 application/json; charset=UTF-8 
2018-04-10 23:07:09.7430|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=de27c44c77794a2996d02b667c878e5e&nonce=e26aab102dcf4f069ccf224aef141325   
2018-04-10 23:07:09.7973|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:09.8569|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:09.8982|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:07:09.9530|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:07:09.9983|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:07:10.0981|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:07:10.2414|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:07:10.3036|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:07:10.6093|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:07:10.8668|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "de27c44c77794a2996d02b667c878e5e",
  "Nonce": "e26aab102dcf4f069ccf224aef141325",
  "SessionId": "4f549fa725685341934f343c3b58a802",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "de27c44c77794a2996d02b667c878e5e",
    "nonce": "e26aab102dcf4f069ccf224aef141325"
  }
} 
2018-04-10 23:07:10.9671|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:07:11.0552|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (20ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:07:11.2973|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:07:11.5410|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (156ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:07:11.7400|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:07:12.0165|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:07:12.1222|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:07:12.2377|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:07:12.3082|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:07:12.4018|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (8ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:07:12.4692|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:07:12.5287|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:07:12.6015|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:07:13.2977|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:07:13.3500|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (7ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:07:13.4001|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:07:13.4467|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:07:13.4882|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:07:13.6128|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "de27c44c77794a2996d02b667c878e5e",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:07:13.7529|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:07:13.7903|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:07:13.8851|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 4193.0763ms 302  
2018-04-10 23:07:18.2904|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:07:18.4209|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:07:18.4610|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:07:18.4930|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:07:18.5226|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:07:18.5503|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:07:18.5858|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:07:18.6161|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:07:18.6518|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:07:18.7109|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 483.5461ms 200 application/json; charset=UTF-8 
2018-04-10 23:07:18.8291|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:07:18.8714|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 
2018-04-10 23:07:18.9150|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:07:18.9673|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:07:19.0121|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:07:19.0856|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:07:19.1299|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:07:19.1731|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:07:19.3823|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:07:19.5377|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 693.5487ms 200 application/json; charset=UTF-8 
2018-04-10 23:07:19.6206|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 OPTIONS http://localhost:5000/connect/userinfo   
2018-04-10 23:07:19.6506|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:07:19.6790|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:07:19.7091|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:07:19.7454|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:07:19.7815|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 173.1527ms 204  
2018-04-10 23:07:19.8201|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/userinfo   
2018-04-10 23:07:19.8534|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:07:19.8825|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:07:19.9159|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:07:19.9506|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:07:20.0276|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/userinfo matched to endpoint type Userinfo 
2018-04-10 23:07:20.0850|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint 
2018-04-10 23:07:20.1311|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo 
2018-04-10 23:07:20.2192|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|Start userinfo request 
2018-04-10 23:07:20.2820|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|Bearer token found in header 
2018-04-10 23:07:20.5833|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:07:20.7275|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (58ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:07:20.8117|0|IdentityServer4.Validation.TokenValidator|DEBUG|Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator 
2018-04-10 23:07:20.9627|0|IdentityServer4.Validation.TokenValidator|DEBUG|Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523372832,
    "exp": 1523380032,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523372790,
    "idp": "local",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} 
2018-04-10 23:07:21.0416|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Creating userinfo response 
2018-04-10 23:07:21.0962|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:07:21.2010|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:07:21.2688|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified 
2018-04-10 23:07:21.3020|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:07:21.3439|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (8ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:07:21.3854|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:07:21.4306|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (11ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:07:21.4697|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (12ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:07:21.5016|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|Profile service returned to the following claim types: sub preferred_username name email email_verified 
2018-04-10 23:07:21.5314|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|End userinfo request 
2018-04-10 23:07:21.6363|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1752.4834ms 200 application/json; charset=UTF-8 
2018-04-10 23:07:21.6879|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:07:21.7159|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:21.7623|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:21.8182|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:07:21.8791|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:07:21.9215|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:07:21.9655|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:07:22.0318|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 352.1981ms 200 text/html; charset=UTF-8 
2018-04-10 23:07:24.0954|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=72cd9102487640b9906b4c09dbc40d07&nonce=80a8bfa6a19a4b5485eca924c3645204&prompt=none   
2018-04-10 23:07:24.1358|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:24.1697|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:24.1955|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:07:24.2209|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:07:24.2485|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:07:24.2867|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:07:24.3538|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:07:24.4158|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:07:24.4630|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "72cd9102487640b9906b4c09dbc40d07",
    "nonce": "80a8bfa6a19a4b5485eca924c3645204",
    "prompt": "none"
  }
} 
2018-04-10 23:07:24.5485|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:07:24.5975|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "72cd9102487640b9906b4c09dbc40d07",
    "nonce": "80a8bfa6a19a4b5485eca924c3645204",
    "prompt": "none"
  }
} 
2018-04-10 23:07:24.7660|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 609.1211ms 302  
2018-04-10 23:07:24.8449|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsraznfuBVFG6ujeee1kj9xjZkGQwN6GtTM_O76DBQ5LURT9LG_5ZB96J9ZslltgSsVX8lAWaMWOMufBK1jJ_-v8R78pvJiiAEQQAZae4c_C7jZJJobB2qAQz4uYe6EiKW4TKSdJPFrvkS16vgTtCgWWuJ57L38xq0JVWL2xhXqAhPXpu7Asum2msUrxS0EIs2B-E_GflFq8ue97TlhguxcogAZ1tDFyVcWMvQHFpT2jtLmgeYc3soKZ0_QqlDxoqDjUsmo9WK_0af2fcECHOplaDEgIf8tRfjcAFP0YseunzA   
2018-04-10 23:07:24.9089|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:24.9631|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:07:25.0215|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsraznfuBVFG6ujeee1kj9xjZkGQwN6GtTM_O76DBQ5LURT9LG_5ZB96J9ZslltgSsVX8lAWaMWOMufBK1jJ_-v8R78pvJiiAEQQAZae4c_C7jZJJobB2qAQz4uYe6EiKW4TKSdJPFrvkS16vgTtCgWWuJ57L38xq0JVWL2xhXqAhPXpu7Asum2msUrxS0EIs2B-E_GflFq8ue97TlhguxcogAZ1tDFyVcWMvQHFpT2jtLmgeYc3soKZ0_QqlDxoqDjUsmo9WK_0af2fcECHOplaDEgIf8tRfjcAFP0YseunzA) - ModelState is Valid 
2018-04-10 23:07:27.2308|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:07:27.3098|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 2274.7562ms 
2018-04-10 23:07:27.3479|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2527.7219ms 200 text/html; charset=utf-8 
2018-04-10 23:08:00.2016|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:08:00.2778|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:08:00.3753|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:08:00.4552|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:08:00.5274|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:08:00.6541|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 388.9232ms 200 application/json; charset=UTF-8 
2018-04-10 23:08:01.0697|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:08:01.1215|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:08:01.1938|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:08:01.2319|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:08:01.2610|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:08:01.3053|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 317.7571ms 200 application/json; charset=UTF-8 
2018-04-10 23:15:12.6489|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:15:12.8255|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:15:12.8720|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:15:12.8926|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:15:12.9126|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:15:13.5144|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:15:14.6436|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:15:14.8274|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:15:14.9132|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:15:15.4919|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:15:24.9097|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:15:24.9819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:15:25.1405|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:15:25.2215|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:15:25.2744|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:15:25.9923|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:15:26.3873|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1403.7902ms 200 application/json; charset=UTF-8 
2018-04-10 23:15:27.0274|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:15:27.1097|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:15:27.1518|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:15:27.2304|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:15:27.2997|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:15:27.8321|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 817.0773ms 200 application/json; charset=UTF-8 
2018-04-10 23:15:32.0895|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 16650.1555ms 
2018-04-10 23:15:32.1224|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 17594.9275ms 200 text/html; charset=utf-8 
2018-04-10 23:18:29.0555|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:18:29.2412|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:18:29.2938|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:18:29.3652|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:18:29.4160|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:18:30.1173|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:18:31.2231|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:18:31.4852|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:18:31.5822|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:18:32.3096|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:18:40.0806|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:18:43.4252|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 11210.7408ms 
2018-04-10 23:18:43.4539|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 12502.5783ms 200 text/html; charset=utf-8 
2018-04-10 23:18:45.5889|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:18:45.6404|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:18:45.6984|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:18:45.7234|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:18:45.7571|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:18:46.4005|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 804.189ms 200 application/json; charset=UTF-8 
2018-04-10 23:18:46.6843|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:18:46.7155|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:18:46.7467|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:18:46.7728|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:18:46.8293|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:18:47.1006|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 412.0695ms 200 application/json; charset=UTF-8 
2018-04-10 23:20:59.7361|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:20:59.8971|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:20:59.9330|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:20:59.9647|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:20:59.9992|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:21:00.8094|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:21:01.6936|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:21:01.7094|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 POST http://localhost:5000/Account/Logout application/x-www-form-urlencoded 225 
2018-04-10 23:21:02.0711|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:21:02.0711|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:21:02.2016|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:21:02.2309|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:21:03.2668|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:21:03.4981|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Logout (KiraNet.Camellia.AuthorizationServer) with arguments (KiraNet.Camellia.AuthorizationServer.Quickstart.Account.LogoutInputModel) - ModelState is Valid 
2018-04-10 23:21:05.6269|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed out. 
2018-04-10 23:21:05.7610|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.External signed out. 
2018-04-10 23:21:05.8234|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.TwoFactorUserId signed out. 
2018-04-10 23:21:05.8790|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|User logged out. 
2018-04-10 23:21:16.7723|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:21:16.7920|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml. 
2018-04-10 23:21:20.7232|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Logout (KiraNet.Camellia.AuthorizationServer) in 17255.7669ms 
2018-04-10 23:21:20.9400|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/endsession/callback?endSessionId=CfDJ8BC_M7YetWVIrJcwI8SRrspKGsM1RalrOnwuIQ-DIhusZ5dIacfvzaWvhgyZKHc3094uYWoAIERkOLBRz9TVlB6GOIbkIxf9jEODd_t9bnBH2zPf7mE1MuSB4WJlqlmtLMkA71ngWJqW32RIvE19uC6I09czlYZoNYZ99-k35Ro9Kef1z3lE5bLa58r4C6OBoWbCJ-f6SIOLJ94nMVMxadc4U7RVWC5-8D_P7UUUzzu9jDUGuQIIAvBjQZGoI5lPOELDtOqWORYzi7AAdOfPvm47hGKdmHNewcZ_sdVEesqbC-exFkRUlh9fxXc0frrQ0SCDigXyu1vbJUb2qitMDWw   
2018-04-10 23:21:20.9660|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 17272.7641ms 
2018-04-10 23:21:21.2496|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 19338.5168ms 200 text/html; charset=utf-8 
2018-04-10 23:21:21.7208|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 19488.0203ms 200 text/html; charset=utf-8 
2018-04-10 23:21:21.8019|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/endsession/callback matched to endpoint type Endsession 
2018-04-10 23:21:22.3185|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint 
2018-04-10 23:21:22.3544|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback 
2018-04-10 23:21:22.4098|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|Processing signout callback request 
2018-04-10 23:21:22.6733|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|No client front-channel logout URLs 
2018-04-10 23:21:22.7105|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|No client back-channel logout URLs 
2018-04-10 23:21:22.8225|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|INFO|Successful signout callback. 
2018-04-10 23:21:23.2263|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|No client front-channel iframe urls 
2018-04-10 23:21:23.4872|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|No client back-channel iframe urls 
2018-04-10 23:21:23.6239|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2886.9351ms 200 text/html; charset=UTF-8 
2018-04-10 23:21:25.8534|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:21:25.8943|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:21:25.9670|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:21:26.0313|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:21:26.1945|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:21:26.2459|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:21:26.3165|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:21:26.3540|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:21:26.8749|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:21:27.3273|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1414.6287ms 200 application/json; charset=UTF-8 
2018-04-10 23:21:27.3706|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:21:27.4552|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:21:27.5024|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:21:27.5430|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:21:27.6040|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:21:27.7108|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 309.0676ms 200 text/html; charset=UTF-8 
2018-04-10 23:21:29.9012|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=8d679087ce0d4380ae6c2651a39f9221&nonce=d41f2ed780684388ac7cd111e291522f&prompt=none   
2018-04-10 23:21:29.9417|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:21:29.9768|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:21:30.0046|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:21:30.0454|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:21:30.0887|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:21:30.1348|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:21:30.2391|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "8d679087ce0d4380ae6c2651a39f9221",
    "nonce": "d41f2ed780684388ac7cd111e291522f",
    "prompt": "none"
  }
} 
2018-04-10 23:21:30.2840|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:21:30.4228|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "8d679087ce0d4380ae6c2651a39f9221",
    "nonce": "d41f2ed780684388ac7cd111e291522f",
    "prompt": "none"
  }
} 
2018-04-10 23:21:30.5856|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 686.1967ms 302  
2018-04-10 23:21:30.6212|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsokzGx0mwrHvo3osN6M7Qvlg6IzZGUZAjXOO3qwStWOLLctXKADmFcW-N0iWM-0Y4yxaoxijRi_cY9Sqyd2EJF5zhvLcHKc72vk_JjB9JCm-6nTsaWY_hZ5rGnnJNul9LLcpM1z6QXMs65kvNDvbjAOdb5yXqLl6BCxky6lNCx3YRo-yAZDENnEDO_HM29fTnsnKsnlBYNwKj7oz3wu4KAOsEHK6PpvR_zXQpjhdRabBBc_F5ZscSbKSqGolBlZDWZb473lKcknh3jxwX4p32Mhn2G44A1Itwoay8fcvrQhlQ   
2018-04-10 23:21:30.6664|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsokzGx0mwrHvo3osN6M7Qvlg6IzZGUZAjXOO3qwStWOLLctXKADmFcW-N0iWM-0Y4yxaoxijRi_cY9Sqyd2EJF5zhvLcHKc72vk_JjB9JCm-6nTsaWY_hZ5rGnnJNul9LLcpM1z6QXMs65kvNDvbjAOdb5yXqLl6BCxky6lNCx3YRo-yAZDENnEDO_HM29fTnsnKsnlBYNwKj7oz3wu4KAOsEHK6PpvR_zXQpjhdRabBBc_F5ZscSbKSqGolBlZDWZb473lKcknh3jxwX4p32Mhn2G44A1Itwoay8fcvrQhlQ) - ModelState is Valid 
2018-04-10 23:21:31.4034|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:21:31.4630|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 793.765ms 
2018-04-10 23:21:31.5714|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 879.0906ms 200 text/html; charset=utf-8 
2018-04-10 23:21:35.2273|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:21:35.2538|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:21:35.2823|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:21:35.3273|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:21:35.3669|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:21:35.4119|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 166.1627ms 200 application/json; charset=UTF-8 
2018-04-10 23:21:35.7356|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:21:35.7562|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:21:35.7832|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:21:35.8066|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:21:35.8402|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:21:36.0383|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 305.1444ms 200 application/json; charset=UTF-8 
2018-04-10 23:21:49.4079|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:21:49.6175|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:21:49.6797|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:21:49.7295|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:21:49.7706|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:21:49.9691|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:21:49.9999|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:21:50.0452|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:21:50.1132|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:21:50.7182|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 766.0182ms 200 application/json; charset=UTF-8 
2018-04-10 23:21:50.7962|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20role%20client_name&state=4918a5841144453b99a8dcede13cb41a&nonce=3da03f030ff048c2b67091a30e202453   
2018-04-10 23:21:50.8782|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:21:50.9268|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:21:51.1291|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:21:51.2517|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:21:51.3211|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:21:51.5568|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:21:51.7508|0|IdentityServer4.Validation.ScopeValidator|ERROR|Invalid scope: role 
2018-04-10 23:21:51.8516|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:21:52.0717|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "4918a5841144453b99a8dcede13cb41a",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "4918a5841144453b99a8dcede13cb41a",
    "nonce": "3da03f030ff048c2b67091a30e202453"
  }
} 
2018-04-10 23:21:52.2172|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1430.2477ms 302  
2018-04-10 23:21:52.3031|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrso0_fQDvA8RCjB7XbMV9sPrVrxW9peE4zGMmqCGZlLyHa8YpUFThT4SXkX5nb8N8dsfdqyBSsjOkfH60HA3ktPvzhs4gLsOTz76RkQn9Wyabs8mmZf4lBb7mRw8e8GmEvOuHgxNKXJ8oIskgI9KyIJuisVA_hCvExVSsuBQetoqQSMn_1ViRf48DthFjmNxM6hIlO6qldmXQmu0YfRwUMHGjaMR4YEWWLZfpPHhjD1PLiqFXxKDfn0ChZVksvNrB_LVZD56xr1oclQgFcBPPqqHUGesNKk7mk_bXpfTUTu__zqg6y_MjwtV9UVJ1QUfqOcRhjYVP6Hwhpg10qaHonH0SfL6Pm1-8PnZE4eZu6My0J2kxdWMROZdA60C8legvTJg07uwQJBLNXxbk-arWnHn   
2018-04-10 23:21:52.3717|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrso0_fQDvA8RCjB7XbMV9sPrVrxW9peE4zGMmqCGZlLyHa8YpUFThT4SXkX5nb8N8dsfdqyBSsjOkfH60HA3ktPvzhs4gLsOTz76RkQn9Wyabs8mmZf4lBb7mRw8e8GmEvOuHgxNKXJ8oIskgI9KyIJuisVA_hCvExVSsuBQetoqQSMn_1ViRf48DthFjmNxM6hIlO6qldmXQmu0YfRwUMHGjaMR4YEWWLZfpPHhjD1PLiqFXxKDfn0ChZVksvNrB_LVZD56xr1oclQgFcBPPqqHUGesNKk7mk_bXpfTUTu__zqg6y_MjwtV9UVJ1QUfqOcRhjYVP6Hwhpg10qaHonH0SfL6Pm1-8PnZE4eZu6My0J2kxdWMROZdA60C8legvTJg07uwQJBLNXxbk-arWnHn) - ModelState is Valid 
2018-04-10 23:21:52.4817|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:21:52.7911|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 171.4593ms 
2018-04-10 23:21:53.6173|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 552.8906ms 200 text/html; charset=utf-8 
2018-04-10 23:23:40.1200|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:23:40.3401|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:23:40.3752|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:23:40.4156|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:23:40.4463|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:23:41.0260|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:23:42.0068|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:23:43.0204|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:23:47.2753|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20role%20client_name&state=36bbadd9c5dd40c9aabcd397073e76ce&nonce=2c165f285f0a4067873fe54bd878d573   
2018-04-10 23:23:47.3353|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:23:47.4230|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:23:47.4878|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:23:47.5671|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:23:47.7109|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:23:47.7649|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:23:48.0469|0|IdentityServer4.Validation.ScopeValidator|ERROR|Invalid scope: role 
2018-04-10 23:23:48.1356|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:23:49.3037|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "36bbadd9c5dd40c9aabcd397073e76ce",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "36bbadd9c5dd40c9aabcd397073e76ce",
    "nonce": "2c165f285f0a4067873fe54bd878d573"
  }
} 
2018-04-10 23:23:50.0733|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2568.6755ms 302  
2018-04-10 23:23:50.1906|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrspsrAeMscATmf14pc6ErQlT0uUF2_czy7HdFSQh8k7r22NL6wTznF0tsfHLsCc2IetZMC_kBM3th7kkQ_qv_gxgLvzHFMGYfiVaPxeTFbthiLcwodazHTgrKrAlurOGY_ybOIbJAo_deYaTv7Wq9xE73x8hg11mMsn-YKj3-JjcI97K6fA64o9mo1DNm0QuNcHeNBH9SY8uUrx0RCZ8LJw-lx2PK-39cEvPiFL486hVZUH5AWTVZrgGip5SnXGyUNcpV3jCgi4v_xefpZ-s-iPbRc4RPdgTyqKdj8b1OtXZBKk5nSxTplVPcaBSA8wPeQw6Ws41BDvYciOTF2XQmBYt3jEi_SJgm7HJObhtypmTPaUUAv0hGAt8tiK7gsKqBBCfwM3c5cMl6PLhtvuovf13   
2018-04-10 23:23:50.4815|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrspsrAeMscATmf14pc6ErQlT0uUF2_czy7HdFSQh8k7r22NL6wTznF0tsfHLsCc2IetZMC_kBM3th7kkQ_qv_gxgLvzHFMGYfiVaPxeTFbthiLcwodazHTgrKrAlurOGY_ybOIbJAo_deYaTv7Wq9xE73x8hg11mMsn-YKj3-JjcI97K6fA64o9mo1DNm0QuNcHeNBH9SY8uUrx0RCZ8LJw-lx2PK-39cEvPiFL486hVZUH5AWTVZrgGip5SnXGyUNcpV3jCgi4v_xefpZ-s-iPbRc4RPdgTyqKdj8b1OtXZBKk5nSxTplVPcaBSA8wPeQw6Ws41BDvYciOTF2XQmBYt3jEi_SJgm7HJObhtypmTPaUUAv0hGAt8tiK7gsKqBBCfwM3c5cMl6PLhtvuovf13) - ModelState is Valid 
2018-04-10 23:23:55.5960|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:23:55.6052|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:24:00.0119|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 16492.7021ms 
2018-04-10 23:24:00.3331|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 9028.6263ms 
2018-04-10 23:24:00.4395|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 10194.7012ms 200 text/html; charset=utf-8 
2018-04-10 23:24:00.4645|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 18345.494ms 200 text/html; charset=utf-8 
2018-04-10 23:25:08.8134|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrspsrAeMscATmf14pc6ErQlT0uUF2_czy7HdFSQh8k7r22NL6wTznF0tsfHLsCc2IetZMC_kBM3th7kkQ_qv_gxgLvzHFMGYfiVaPxeTFbthiLcwodazHTgrKrAlurOGY_ybOIbJAo_deYaTv7Wq9xE73x8hg11mMsn-YKj3-JjcI97K6fA64o9mo1DNm0QuNcHeNBH9SY8uUrx0RCZ8LJw-lx2PK-39cEvPiFL486hVZUH5AWTVZrgGip5SnXGyUNcpV3jCgi4v_xefpZ-s-iPbRc4RPdgTyqKdj8b1OtXZBKk5nSxTplVPcaBSA8wPeQw6Ws41BDvYciOTF2XQmBYt3jEi_SJgm7HJObhtypmTPaUUAv0hGAt8tiK7gsKqBBCfwM3c5cMl6PLhtvuovf13   
2018-04-10 23:25:08.8583|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrspsrAeMscATmf14pc6ErQlT0uUF2_czy7HdFSQh8k7r22NL6wTznF0tsfHLsCc2IetZMC_kBM3th7kkQ_qv_gxgLvzHFMGYfiVaPxeTFbthiLcwodazHTgrKrAlurOGY_ybOIbJAo_deYaTv7Wq9xE73x8hg11mMsn-YKj3-JjcI97K6fA64o9mo1DNm0QuNcHeNBH9SY8uUrx0RCZ8LJw-lx2PK-39cEvPiFL486hVZUH5AWTVZrgGip5SnXGyUNcpV3jCgi4v_xefpZ-s-iPbRc4RPdgTyqKdj8b1OtXZBKk5nSxTplVPcaBSA8wPeQw6Ws41BDvYciOTF2XQmBYt3jEi_SJgm7HJObhtypmTPaUUAv0hGAt8tiK7gsKqBBCfwM3c5cMl6PLhtvuovf13) - ModelState is Valid 
2018-04-10 23:25:08.9172|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:25:09.0430|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 125.3282ms 
2018-04-10 23:25:09.1773|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 290.2202ms 200 text/html; charset=utf-8 
2018-04-10 23:25:22.3651|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20role%20client_name&state=a614552f93664ec499c7c0b7c6c3afd8&nonce=a40f4df7cdc04c8fae85360b6a223d80   
2018-04-10 23:25:22.7683|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:25:24.0789|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:25:24.5474|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:25:25.5250|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:25:25.6095|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:25:26.0924|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:25:26.2462|0|IdentityServer4.Validation.ScopeValidator|ERROR|Invalid scope: role 
2018-04-10 23:25:26.3118|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:25:26.4085|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "a614552f93664ec499c7c0b7c6c3afd8",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "a614552f93664ec499c7c0b7c6c3afd8",
    "nonce": "a40f4df7cdc04c8fae85360b6a223d80"
  }
} 
2018-04-10 23:25:26.5321|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 4150.5555ms 302  
2018-04-10 23:25:26.5974|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrspGjEIkZMYR26KUyDQ6ZSl__UJQnyL8ODN_DrWrMpGrYQtr1Icv7JyEfL3HJwXV6i5Mm-R1t9I4eFfimA7ELAdb13rV70m7CJWro2MrVHeaMepVIC5nWMuMEFoDtPTQfzEaa6qybRUYbT_bp9Lbxf7Mgk3jrk4ERLVN7_Fy7wzqb69cVrZyPEeA8lz9bLjUSJRMTEVVbzx2BVXpVlhxAMJ102LgUKeMczT-0IEFiCoEbIBpXspQ8PNBb-aveRK5pJXPIe8PDJ5xvmRn81sRXowwYOQgjJDh5CecLRFSIFmlSXqmf6fUNAriX_ur-JOnv80pamNd1aAW438_30z4Mdgg-_CwQzfIm9fYSOUl7_TqC-wCcAmQs_kC6-CApzhwarLxttFDDlGErPctArgpsuas   
2018-04-10 23:25:26.6325|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrspGjEIkZMYR26KUyDQ6ZSl__UJQnyL8ODN_DrWrMpGrYQtr1Icv7JyEfL3HJwXV6i5Mm-R1t9I4eFfimA7ELAdb13rV70m7CJWro2MrVHeaMepVIC5nWMuMEFoDtPTQfzEaa6qybRUYbT_bp9Lbxf7Mgk3jrk4ERLVN7_Fy7wzqb69cVrZyPEeA8lz9bLjUSJRMTEVVbzx2BVXpVlhxAMJ102LgUKeMczT-0IEFiCoEbIBpXspQ8PNBb-aveRK5pJXPIe8PDJ5xvmRn81sRXowwYOQgjJDh5CecLRFSIFmlSXqmf6fUNAriX_ur-JOnv80pamNd1aAW438_30z4Mdgg-_CwQzfIm9fYSOUl7_TqC-wCcAmQs_kC6-CApzhwarLxttFDDlGErPctArgpsuas) - ModelState is Valid 
2018-04-10 23:25:26.6760|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:25:26.7476|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 91.8401ms 
2018-04-10 23:25:26.8034|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 198.0813ms 200 text/html; charset=utf-8 
2018-04-10 23:26:39.8670|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:26:40.1064|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:26:40.1401|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:26:40.1621|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:26:40.1848|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:26:40.6805|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:26:41.6252|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:26:42.4028|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:26:53.1571|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:26:57.3337|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20role%20client_name&state=8a02ab11d833424293040357bd6f00d6&nonce=d680ca7c93314ec6b81560b75500f6c7   
2018-04-10 23:26:58.1305|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:26:58.5912|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:26:58.6400|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:26:59.2320|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:27:01.6754|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:27:01.8230|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:27:02.2876|0|IdentityServer4.Validation.ScopeValidator|ERROR|Invalid scope: role 
2018-04-10 23:27:02.3826|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:27:03.5113|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "8a02ab11d833424293040357bd6f00d6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "8a02ab11d833424293040357bd6f00d6",
    "nonce": "d680ca7c93314ec6b81560b75500f6c7"
  }
} 
2018-04-10 23:27:03.9283|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 6672.7744ms 302  
2018-04-10 23:27:04.1027|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsoJ3WBlVeO9IXF_orR7zcyDRru4KQCRMx1bVTtizmGJqdqGnt_7nhxJnwodR6-_iQiSIk7fmVqRIJB2-PrO0a7tEcQpRSjBCrF3K6CLACEkFn1DZFY3l2MxfTPvvmZ2tPro-IINz2IdwYBi5wlwrRecSUspbeaxCwQCxz6sV6UYc44Z1xJoh7Wci9a1yQ0iqbGPC7A3iuiQhhg9rUNOv34q-Uwv8FOsrKMydfo4UV3u5TUPeocbR4LoXhgCjWIp-omDjH6s_l04JjMXLIbhjRrqo73M7PPwr_HuIDMyDvQ2wpuWCOxaYRhCSIBblueWTqJ7moa-sAP6I9Oz86pyiQQX5S9xGsusd2bXGJ3PLZUX16nZbn6Gb0xrdmL3zHZ337fVKivNy0R5HMZy6xe32daY   
2018-04-10 23:27:04.8255|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsoJ3WBlVeO9IXF_orR7zcyDRru4KQCRMx1bVTtizmGJqdqGnt_7nhxJnwodR6-_iQiSIk7fmVqRIJB2-PrO0a7tEcQpRSjBCrF3K6CLACEkFn1DZFY3l2MxfTPvvmZ2tPro-IINz2IdwYBi5wlwrRecSUspbeaxCwQCxz6sV6UYc44Z1xJoh7Wci9a1yQ0iqbGPC7A3iuiQhhg9rUNOv34q-Uwv8FOsrKMydfo4UV3u5TUPeocbR4LoXhgCjWIp-omDjH6s_l04JjMXLIbhjRrqo73M7PPwr_HuIDMyDvQ2wpuWCOxaYRhCSIBblueWTqJ7moa-sAP6I9Oz86pyiQQX5S9xGsusd2bXGJ3PLZUX16nZbn6Gb0xrdmL3zHZ337fVKivNy0R5HMZy6xe32daY) - ModelState is Valid 
2018-04-10 23:27:07.0789|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:27:07.1039|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 24684.7703ms 
2018-04-10 23:27:07.1501|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 25588.7948ms 200 text/html; charset=utf-8 
2018-04-10 23:27:07.2991|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 2948.5406ms 
2018-04-10 23:27:07.8508|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 3304.1732ms 200 text/html; charset=utf-8 
2018-04-10 23:27:24.5502|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:27:25.2022|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:27:25.3957|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:27:25.4541|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:27:25.4948|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:27:25.5290|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:27:25.6079|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:27:25.7428|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:27:25.8119|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:27:26.2789|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1777.6157ms 200 application/json; charset=UTF-8 
2018-04-10 23:27:26.5308|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=3e2a930792d8469ebed9fd86af3043da&nonce=76199f280cf64977a5708c7b429646c6   
2018-04-10 23:27:27.0420|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:27:27.1387|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:27:27.1850|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:27:27.2421|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:27:27.3200|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:27:27.3691|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:27:27.4958|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:27:27.5473|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Nonce": "76199f280cf64977a5708c7b429646c6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "3e2a930792d8469ebed9fd86af3043da",
    "nonce": "76199f280cf64977a5708c7b429646c6"
  }
} 
2018-04-10 23:27:27.6932|0|IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator|INFO|Showing login: User is not authenticated 
2018-04-10 23:27:27.7484|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1273.9168ms 302  
2018-04-10 23:27:27.7987|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dclient_id%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A5200%252Flogin-callback%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520email%2520client_name%26state%3D3e2a930792d8469ebed9fd86af3043da%26nonce%3D76199f280cf64977a5708c7b429646c6   
2018-04-10 23:27:27.8992|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments (/connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=3e2a930792d8469ebed9fd86af3043da&nonce=76199f280cf64977a5708c7b429646c6) - ModelState is Valid 
2018-04-10 23:27:27.9903|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.External signed out. 
2018-04-10 23:27:30.6303|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Account/Login.cshtml. 
2018-04-10 23:27:32.7909|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 4903.3041ms 
2018-04-10 23:27:32.8235|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 5032.4885ms 200 text/html; charset=utf-8 
2018-04-10 23:27:43.5291|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 POST http://localhost:5000/Account/Login?returnurl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dclient_id%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A5200%252Flogin-callback%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520email%2520client_name%26state%3D3e2a930792d8469ebed9fd86af3043da%26nonce%3D76199f280cf64977a5708c7b429646c6 application/x-www-form-urlencoded 232 
2018-04-10 23:27:43.7209|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments (KiraNet.Camellia.AuthorizationServer.Models.ViewModels.LoginViewModel, /connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=3e2a930792d8469ebed9fd86af3043da&nonce=76199f280cf64977a5708c7b429646c6) - ModelState is Valid 
2018-04-10 23:27:43.8147|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:27:43.8955|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (26ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Alias], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0 
2018-04-10 23:27:44.7881|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (269ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:27:44.9811|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (35ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:27:45.0394|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (12ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:27:45.1899|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (12ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:27:45.2644|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:27:45.3032|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding idp claim with value: local 
2018-04-10 23:27:45.3357|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding amr claim with value: pwd 
2018-04-10 23:27:45.3759|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding auth_time claim with value: 1523374065 
2018-04-10 23:27:45.4585|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:27:45.5852|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|User logged in. 
2018-04-10 23:27:45.6556|1|Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor|INFO|Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=3e2a930792d8469ebed9fd86af3043da&nonce=76199f280cf64977a5708c7b429646c6. 
2018-04-10 23:27:45.7554|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 2096.3994ms 
2018-04-10 23:27:45.9210|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2283.4197ms 302  
2018-04-10 23:27:46.0281|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=3e2a930792d8469ebed9fd86af3043da&nonce=76199f280cf64977a5708c7b429646c6   
2018-04-10 23:27:46.1597|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:27:46.2073|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:27:46.2449|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize/callback matched to endpoint type Authorize 
2018-04-10 23:27:46.2892|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint 
2018-04-10 23:27:46.3341|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback 
2018-04-10 23:27:46.4155|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|Start authorize callback request 
2018-04-10 23:27:46.4749|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:27:46.5305|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:27:46.5848|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:27:46.6414|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Nonce": "76199f280cf64977a5708c7b429646c6",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "3e2a930792d8469ebed9fd86af3043da",
    "nonce": "76199f280cf64977a5708c7b429646c6"
  }
} 
2018-04-10 23:27:46.7297|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:27:46.8080|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:27:46.9884|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:27:47.2854|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (188ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:27:47.4428|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:27:47.5658|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:27:47.6520|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:27:47.7380|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:27:47.7767|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:27:47.8660|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (26ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:27:47.9396|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (20ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:27:47.9919|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (21ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:27:48.0457|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:27:48.6710|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:27:48.7439|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:27:48.7984|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (20ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:27:48.8549|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (20ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:27:48.9457|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (30ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:27:49.1033|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:27:49.2383|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:27:49.3197|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:27:49.6355|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 3396.6145ms 302  
2018-04-10 23:27:55.7761|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:27:55.8224|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:27:55.8571|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:27:55.8933|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:27:55.9346|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:27:55.9700|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:27:56.0038|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:27:56.0601|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:27:56.0938|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:27:56.1832|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 359.266ms 200 application/json; charset=UTF-8 
2018-04-10 23:27:56.2259|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:27:56.2607|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 
2018-04-10 23:27:56.2984|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:27:56.3320|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:27:56.4688|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:27:56.5192|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:27:56.5800|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:27:56.6219|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:27:56.6679|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:27:57.0658|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 547.7618ms 200 application/json; charset=UTF-8 
2018-04-10 23:27:57.1275|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 OPTIONS http://localhost:5000/connect/userinfo   
2018-04-10 23:27:57.2220|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:27:57.3018|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:27:57.3576|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:27:57.4101|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:27:57.4584|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 326.7978ms 204  
2018-04-10 23:27:57.5219|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/userinfo   
2018-04-10 23:27:57.5881|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:27:57.6738|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:27:57.7218|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:27:57.7656|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:27:58.0697|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/userinfo matched to endpoint type Userinfo 
2018-04-10 23:27:58.2570|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint 
2018-04-10 23:27:58.3153|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo 
2018-04-10 23:27:58.3813|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|Start userinfo request 
2018-04-10 23:27:58.4657|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|Bearer token found in header 
2018-04-10 23:27:58.9726|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:27:59.0363|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:27:59.1069|0|IdentityServer4.Validation.TokenValidator|DEBUG|Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator 
2018-04-10 23:27:59.1723|0|IdentityServer4.Validation.TokenValidator|DEBUG|Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374068,
    "exp": 1523381268,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} 
2018-04-10 23:27:59.2362|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Creating userinfo response 
2018-04-10 23:27:59.3127|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:27:59.3901|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:27:59.5034|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified 
2018-04-10 23:27:59.5579|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:27:59.6325|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:27:59.7539|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (74ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:27:59.8160|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (26ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:27:59.8677|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (12ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:27:59.9036|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|Profile service returned to the following claim types: sub preferred_username name email email_verified 
2018-04-10 23:27:59.9398|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|End userinfo request 
2018-04-10 23:28:00.4187|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2482.7776ms 200 application/json; charset=UTF-8 
2018-04-10 23:28:00.4358|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:28:00.5041|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:00.5378|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:00.6135|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:28:00.6655|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:28:00.7135|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:28:00.7560|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:28:00.8585|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 383.2782ms 200 text/html; charset=UTF-8 
2018-04-10 23:28:03.0740|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=b15c883e32f24622aefe5ee74b9194b4&nonce=dd73e4e87f2240e9b6e09cd599f125e6&prompt=none   
2018-04-10 23:28:03.1043|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:03.1305|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:03.1561|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:28:03.1819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:28:03.2073|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:28:03.2365|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:28:03.2633|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:28:03.2881|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:28:03.3216|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "b15c883e32f24622aefe5ee74b9194b4",
    "nonce": "dd73e4e87f2240e9b6e09cd599f125e6",
    "prompt": "none"
  }
} 
2018-04-10 23:28:03.3552|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:28:03.3914|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "b15c883e32f24622aefe5ee74b9194b4",
    "nonce": "dd73e4e87f2240e9b6e09cd599f125e6",
    "prompt": "none"
  }
} 
2018-04-10 23:28:03.4239|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 349.2083ms 302  
2018-04-10 23:28:03.4620|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsoEyIywXFUpqyoMkgyzoHXVREzASxzjkZGajtZ-sPgVoxygtLd6TCMCHcT3b6TyQWbpY7GLPmL9cLgEeh2kgrc3V686ZUlvuouVf2a16fMYYDpy3dcVL80SxlmoyDafBym3TP2boytHCEXuxeqlQdWVy98qFGG-c7zMrEkKLHUMDQj3tWT41j_dPSPE-MQx1V6a1qU82dnuW5SID2ggo6bssEaIlHIO8XD_O7ZWHiQDTKO1u-yx1EhiSP0zxmWi9JRDVeYwTSfY-qG95j_3MWmfah2EGG5IPVK4VsSOQwVLxA   
2018-04-10 23:28:03.4883|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:03.5141|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:28:03.5458|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsoEyIywXFUpqyoMkgyzoHXVREzASxzjkZGajtZ-sPgVoxygtLd6TCMCHcT3b6TyQWbpY7GLPmL9cLgEeh2kgrc3V686ZUlvuouVf2a16fMYYDpy3dcVL80SxlmoyDafBym3TP2boytHCEXuxeqlQdWVy98qFGG-c7zMrEkKLHUMDQj3tWT41j_dPSPE-MQx1V6a1qU82dnuW5SID2ggo6bssEaIlHIO8XD_O7ZWHiQDTKO1u-yx1EhiSP0zxmWi9JRDVeYwTSfY-qG95j_3MWmfah2EGG5IPVK4VsSOQwVLxA) - ModelState is Valid 
2018-04-10 23:28:03.5928|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:28:03.6969|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 104.0539ms 
2018-04-10 23:28:03.7373|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 261.2015ms 200 text/html; charset=utf-8 
2018-04-10 23:28:10.1010|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:28:10.1425|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:28:10.1852|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:28:10.2230|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:28:10.3094|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:28:10.3897|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 287.3452ms 200 application/json; charset=UTF-8 
2018-04-10 23:28:10.6603|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:28:10.6871|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:28:10.7343|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:28:10.7733|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:28:10.8108|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:28:11.0986|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 186.7092ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:22.3404|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for authentication 
2018-04-10 23:29:22.4819|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-in 
2018-04-10 23:29:22.5127|0|IdentityServer4.Startup|DEBUG|Using Identity.External as default scheme for sign-out 
2018-04-10 23:29:22.5397|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for challenge 
2018-04-10 23:29:22.5604|0|IdentityServer4.Startup|DEBUG|Using Identity.Application as default scheme for forbid 
2018-04-10 23:29:23.6158|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|Starting token cleanup 
2018-04-10 23:29:23.9426|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:29:24.1456|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:24.2569|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:25.0669|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:29:25.4273|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:29:25.5033|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:29:25.5436|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:25.5689|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:25.6041|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:25.6477|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:29:25.6941|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:29:25.7290|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:29:25.7847|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:29:26.8272|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1299.4811ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:26.8544|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=6c147f71c1fb423db6a8c61c4ee07e23&nonce=67e830ae02d3432c9383ab67a8537233   
2018-04-10 23:29:26.9358|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:26.9921|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:27.0295|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:29:27.0836|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:29:27.1167|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:29:27.1825|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:29:27.2675|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:27.3143|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:29:27.5838|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:29:27.9131|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "6c147f71c1fb423db6a8c61c4ee07e23",
  "Nonce": "67e830ae02d3432c9383ab67a8537233",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "6c147f71c1fb423db6a8c61c4ee07e23",
    "nonce": "67e830ae02d3432c9383ab67a8537233"
  }
} 
2018-04-10 23:29:28.0818|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:29:28.2862|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (61ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:29:28.4984|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:29:28.6032|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (7ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:29:28.7808|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:29:29.0267|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:29:29.0907|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:29:29.1694|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:29:29.2025|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:29.4522|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (7ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:29:29.9260|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:29:30.1525|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (108ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:29:30.2823|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (15ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:29:30.7969|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:29:30.8337|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:29:30.8825|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:29:30.9252|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:29:30.9669|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (3ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:29:31.0680|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "6c147f71c1fb423db6a8c61c4ee07e23",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:29:31.2265|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 4403.6191ms 302  
2018-04-10 23:29:37.2639|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:29:37.3347|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:29:37.4031|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:37.6670|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:37.7960|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:37.8858|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:29:38.1622|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:29:38.2335|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:29:38.3000|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:29:38.4263|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1186.9696ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:38.5378|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:29:38.5777|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 
2018-04-10 23:29:38.6063|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:29:38.6378|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:38.6665|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:38.6937|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:38.7404|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:29:38.8351|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:29:38.8801|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:29:38.9851|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:29:39.5903|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 549.3399ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:39.7287|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 OPTIONS http://localhost:5000/connect/userinfo   
2018-04-10 23:29:39.9002|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:29:39.9690|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:40.0703|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:40.1565|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:40.2903|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 488.9225ms 204  
2018-04-10 23:29:40.3317|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/userinfo   
2018-04-10 23:29:40.3628|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:29:40.3965|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:40.4256|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:40.4628|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:40.4956|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/userinfo matched to endpoint type Userinfo 
2018-04-10 23:29:40.5432|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint 
2018-04-10 23:29:40.5731|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo 
2018-04-10 23:29:40.7704|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|Start userinfo request 
2018-04-10 23:29:40.8263|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|Bearer token found in header 
2018-04-10 23:29:41.1744|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:29:41.2287|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (12ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:29:41.2905|0|IdentityServer4.Validation.TokenValidator|DEBUG|Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator 
2018-04-10 23:29:41.3587|0|IdentityServer4.Validation.TokenValidator|DEBUG|Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374170,
    "exp": 1523381370,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} 
2018-04-10 23:29:41.4327|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Creating userinfo response 
2018-04-10 23:29:41.4799|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:29:41.5188|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:29:41.5591|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified 
2018-04-10 23:29:41.5882|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:29:41.6405|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (10ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:29:41.6819|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (17ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:29:41.7323|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:29:41.7737|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:29:41.8083|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|Profile service returned to the following claim types: sub preferred_username name email email_verified 
2018-04-10 23:29:41.8449|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|End userinfo request 
2018-04-10 23:29:41.9657|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1560.2346ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:42.2142|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:29:42.3232|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:42.4319|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:42.6347|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:29:42.8663|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:29:42.8906|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:29:42.9286|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:29:43.0076|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 819.2617ms 200 text/html; charset=UTF-8 
2018-04-10 23:29:44.6936|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 19722.0186ms 
2018-04-10 23:29:44.7263|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 20840.7066ms 200 text/html; charset=utf-8 
2018-04-10 23:29:45.3311|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=d34ac22b269e487996e241aa6652cafa&nonce=276b912745984eb2ae752eb87b02db0c&prompt=none   
2018-04-10 23:29:45.3886|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:45.4242|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:45.4604|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:29:45.5263|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:29:45.6025|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:29:45.7869|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:29:45.8275|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:45.8548|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:29:45.8939|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "d34ac22b269e487996e241aa6652cafa",
    "nonce": "276b912745984eb2ae752eb87b02db0c",
    "prompt": "none"
  }
} 
2018-04-10 23:29:45.9392|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:29:45.9742|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "d34ac22b269e487996e241aa6652cafa",
    "nonce": "276b912745984eb2ae752eb87b02db0c",
    "prompt": "none"
  }
} 
2018-04-10 23:29:46.0548|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 742.818ms 302  
2018-04-10 23:29:46.0911|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsq1cyDhPka6J6s3lbWLmmerh85zmILj5JzcTiyB3mw96-McgYRkWVMyIFP5p5hiYjLnZ5nWepPredXYTamtfjvDLHrUYH30OuP62JZ3L11eH3PhEU4kVUWvHshE1EAhOtGacTj9AiDhcbO1-ieM9vB_eDosevaqx_qTkfL_1IQ-XB8WzKJ6yJ1DVz0ti30wdVTP5Er6_dFvcmH8a0-skIpSwoSNKmac5GJmNJxL-vuntOwnsk2HjWZMi-DBftI-DUWxDzbQBCy7O5bvqR1qiCvy9F-T1EF3EzuRofjQzS9tXA   
2018-04-10 23:29:46.1205|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:46.1735|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:46.3707|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsq1cyDhPka6J6s3lbWLmmerh85zmILj5JzcTiyB3mw96-McgYRkWVMyIFP5p5hiYjLnZ5nWepPredXYTamtfjvDLHrUYH30OuP62JZ3L11eH3PhEU4kVUWvHshE1EAhOtGacTj9AiDhcbO1-ieM9vB_eDosevaqx_qTkfL_1IQ-XB8WzKJ6yJ1DVz0ti30wdVTP5Er6_dFvcmH8a0-skIpSwoSNKmac5GJmNJxL-vuntOwnsk2HjWZMi-DBftI-DUWxDzbQBCy7O5bvqR1qiCvy9F-T1EF3EzuRofjQzS9tXA) - ModelState is Valid 
2018-04-10 23:29:47.2938|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:29:47.5511|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 1118.0381ms 
2018-04-10 23:29:47.5924|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1486.2641ms 200 text/html; charset=utf-8 
2018-04-10 23:29:53.5220|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:29:53.5853|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:29:53.6312|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:29:53.6786|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:29:53.7281|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:29:53.7763|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:29:53.9272|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:29:54.1721|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:29:54.2683|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:29:54.4051|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 795.4263ms 200 application/json; charset=UTF-8 
2018-04-10 23:29:54.4671|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=93cf542f648b49f2839c4ca7b66d5ed5&nonce=a485d8a81fb64cf98961e3e990743d1e   
2018-04-10 23:29:54.5944|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:54.8152|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:55.2035|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:29:55.8239|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:29:56.2535|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=360e4b47eaf245679d198aeb59817c2c&nonce=53bf0fb35a754dc6b3f442021859735a   
2018-04-10 23:29:56.3278|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:29:56.3424|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:56.3884|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:29:56.4096|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:29:56.4733|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:56.5170|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:29:56.5568|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:29:56.5930|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:29:56.6684|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:29:56.6844|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:29:56.7286|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "93cf542f648b49f2839c4ca7b66d5ed5",
  "Nonce": "a485d8a81fb64cf98961e3e990743d1e",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "93cf542f648b49f2839c4ca7b66d5ed5",
    "nonce": "a485d8a81fb64cf98961e3e990743d1e"
  }
} 
2018-04-10 23:29:57.0038|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:29:57.1757|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:57.2428|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:29:57.3031|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:29:57.3554|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "360e4b47eaf245679d198aeb59817c2c",
  "Nonce": "53bf0fb35a754dc6b3f442021859735a",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "360e4b47eaf245679d198aeb59817c2c",
    "nonce": "53bf0fb35a754dc6b3f442021859735a"
  }
} 
2018-04-10 23:29:57.5249|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:29:57.6278|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (30ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:29:57.7137|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:29:57.7673|0|IdentityServer4.Hosting.IdentityServerMiddleware|FATAL|Unhandled exception: The operation was canceled. The operation was canceled.
2018-04-10 23:29:57.8061|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:29:57.8672|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:29:57.9522|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:29:58.0553|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:29:58.1745|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:29:58.2192|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:29:58.2776|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (8ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:29:58.3496|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (18ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:29:58.4455|0|Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware|ERROR|An unhandled exception has occurred while executing the request The operation was canceled.
2018-04-10 23:29:58.4995|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:29:58.5512|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:29:58.6078|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:29:58.7361|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (15ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:29:59.0889|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (135ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:29:59.2304|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (50ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:29:59.3706|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (54ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:29:59.4697|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 5034.6805ms 500 text/html; charset=utf-8 
2018-04-10 23:29:59.4854|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "360e4b47eaf245679d198aeb59817c2c",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:29:59.5859|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 3455.7803ms 302  
2018-04-10 23:30:05.6823|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:30:05.9476|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:30:05.9923|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:06.1626|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:06.4354|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:06.6747|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:30:06.8214|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:30:06.8857|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:30:06.9396|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:30:07.0911|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1287.7039ms 200 application/json; charset=UTF-8 
2018-04-10 23:30:07.1512|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:30:07.1887|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 
2018-04-10 23:30:07.2375|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:07.3047|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:07.3869|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:07.4351|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:30:07.5430|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:30:07.6190|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:30:07.8679|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:30:08.0540|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 775.9781ms 200 application/json; charset=UTF-8 
2018-04-10 23:30:08.1900|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 OPTIONS http://localhost:5000/connect/userinfo   
2018-04-10 23:30:08.2135|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:30:08.2375|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:08.2631|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:08.2998|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:08.3663|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 136.6417ms 204  
2018-04-10 23:30:08.4161|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/userinfo   
2018-04-10 23:30:08.4914|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:30:08.5482|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:08.6482|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:08.6964|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:08.7568|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/userinfo matched to endpoint type Userinfo 
2018-04-10 23:30:08.7915|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint 
2018-04-10 23:30:08.8243|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo 
2018-04-10 23:30:08.8552|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|Start userinfo request 
2018-04-10 23:30:08.8875|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|Bearer token found in header 
2018-04-10 23:30:08.9306|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:30:08.9910|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (29ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:30:09.0375|0|IdentityServer4.Validation.TokenValidator|DEBUG|Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator 
2018-04-10 23:30:09.0758|0|IdentityServer4.Validation.TokenValidator|DEBUG|Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374198,
    "exp": 1523381398,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} 
2018-04-10 23:30:09.1429|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Creating userinfo response 
2018-04-10 23:30:09.2104|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:30:09.3206|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:30:09.4046|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified 
2018-04-10 23:30:09.4418|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:30:09.5444|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (7ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:30:09.6611|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:30:09.7872|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (21ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:30:10.1949|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (58ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:30:10.3524|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|Profile service returned to the following claim types: sub preferred_username name email email_verified 
2018-04-10 23:30:10.4466|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|End userinfo request 
2018-04-10 23:30:10.8916|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2090.8211ms 200 application/json; charset=UTF-8 
2018-04-10 23:30:11.0182|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:30:11.0868|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:11.1229|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:11.2782|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:30:11.4943|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:30:11.5498|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:30:11.6188|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:30:11.7574|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 865.1163ms 200 text/html; charset=UTF-8 
2018-04-10 23:30:12.2640|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/   
2018-04-10 23:30:12.2976|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:12.3189|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:12.3460|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) with arguments ((null)) - ModelState is Valid 
2018-04-10 23:30:12.3716|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Index.cshtml. 
2018-04-10 23:30:12.4197|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Index (KiraNet.Camellia.AuthorizationServer) in 56.9965ms 
2018-04-10 23:30:12.5776|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 186.8231ms 200 text/html; charset=utf-8 
2018-04-10 23:30:14.6691|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 POST http://localhost:5000/Account/Logout application/x-www-form-urlencoded 225 
2018-04-10 23:30:14.6948|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:14.7192|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:30:14.9062|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Logout (KiraNet.Camellia.AuthorizationServer) with arguments (KiraNet.Camellia.AuthorizationServer.Quickstart.Account.LogoutInputModel) - ModelState is Valid 
2018-04-10 23:30:15.1155|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed out. 
2018-04-10 23:30:15.1544|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.External signed out. 
2018-04-10 23:30:15.1914|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.TwoFactorUserId signed out. 
2018-04-10 23:30:15.2353|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|User logged out. 
2018-04-10 23:30:16.5342|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Account/LoggedOut.cshtml. 
2018-04-10 23:30:16.6642|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Logout (KiraNet.Camellia.AuthorizationServer) in 1816.2124ms 
2018-04-10 23:30:16.7487|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/endsession/callback?endSessionId=CfDJ8BC_M7YetWVIrJcwI8SRrsp0jn9GHYSFz1zrEk5zMHZ63TEp_ndT_5EGt5nGLXzAib9AENRgOFFCgsihJ0nJj0-oIC0PwDDWtb-nWrbxSC6Iydg_FCjiMTwIg_H8TEisGzqI3I17o6-7tXn6OQtJ8dMxNNOYgyfopuSK71lPJA4Ag_HPh6_dz8LbPPRxTFiEAQm_QajRTaKiz2g1d1PNxvlsCdyi9HbRYOgYgpGn96FdtVAjLSUHUpDGd-FjJyQYsdKT1DzeeKeRfbPLVbPQ7gyeHrhHflnfuOycdeiUpylgxi8IlLlqxr-Lp555F0ffaA9Vq1Szg4Jg1OZizahPQM4   
2018-04-10 23:30:16.8362|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2115.1278ms 200 text/html; charset=utf-8 
2018-04-10 23:30:17.0160|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/endsession/callback matched to endpoint type Endsession 
2018-04-10 23:30:17.1954|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint 
2018-04-10 23:30:17.2404|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback 
2018-04-10 23:30:17.3103|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|Processing signout callback request 
2018-04-10 23:30:17.3868|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|No client front-channel logout URLs 
2018-04-10 23:30:17.4210|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|No client back-channel logout URLs 
2018-04-10 23:30:17.4660|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|INFO|Successful signout callback. 
2018-04-10 23:30:17.5232|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|No client front-channel iframe urls 
2018-04-10 23:30:17.5891|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|No client back-channel iframe urls 
2018-04-10 23:30:17.6622|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 967.6026ms 200 text/html; charset=UTF-8 
2018-04-10 23:30:28.0925|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:30:28.1480|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:30:28.1908|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:28.2191|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:28.2571|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:28.2977|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:30:28.3345|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:30:28.3713|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:30:28.4299|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:30:28.6465|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 585.7493ms 200 application/json; charset=UTF-8 
2018-04-10 23:30:28.8768|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:30:29.0294|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:30:29.1348|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:30:29.2768|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:30:29.3454|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:30:29.5263|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 835.6298ms 200 text/html; charset=UTF-8 
2018-04-10 23:30:31.6077|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=19a8e4070de94baebf9d1fcf882017d2&nonce=02dcf6259c89411db2897a2b518d535a&prompt=none   
2018-04-10 23:30:31.6410|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:30:31.6728|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:30:31.7079|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:30:31.7391|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:30:31.7695|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:30:31.7970|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:30:31.8281|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "19a8e4070de94baebf9d1fcf882017d2",
    "nonce": "02dcf6259c89411db2897a2b518d535a",
    "prompt": "none"
  }
} 
2018-04-10 23:30:31.8693|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:30:31.9128|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "19a8e4070de94baebf9d1fcf882017d2",
    "nonce": "02dcf6259c89411db2897a2b518d535a",
    "prompt": "none"
  }
} 
2018-04-10 23:30:31.9593|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 344.9661ms 302  
2018-04-10 23:30:32.0171|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsrdFtny1iJUKguhw5IozAN-hIiOjjXc0cwgHFnioLojH3vkzGuOTGyV0ZBmzWGDF0Y65s4JKJXCsvLp0mM_PoLl4yNBL0vlvzbWe8jKt9v8rRodYT7aQINU-IpmXaV4T6Ubg4x7vsmtTndeQGlysm4dq9qNlDRD-7wJCJThMK6tZ2elkYxp4Dt01QUcxJZA9rhecvf3bQyOIzx3OY89FHhwLaopDAQYYBN2yp7hSkJ4K6JOELIohx6dJvxJlAgfCgnQ3pSkyQnLStm3kASf2-s3mEFP_MrbskLnTfQfNtC41g   
2018-04-10 23:30:32.0518|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsrdFtny1iJUKguhw5IozAN-hIiOjjXc0cwgHFnioLojH3vkzGuOTGyV0ZBmzWGDF0Y65s4JKJXCsvLp0mM_PoLl4yNBL0vlvzbWe8jKt9v8rRodYT7aQINU-IpmXaV4T6Ubg4x7vsmtTndeQGlysm4dq9qNlDRD-7wJCJThMK6tZ2elkYxp4Dt01QUcxJZA9rhecvf3bQyOIzx3OY89FHhwLaopDAQYYBN2yp7hSkJ4K6JOELIohx6dJvxJlAgfCgnQ3pSkyQnLStm3kASf2-s3mEFP_MrbskLnTfQfNtC41g) - ModelState is Valid 
2018-04-10 23:30:32.0870|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:30:32.1759|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 73.1656ms 
2018-04-10 23:30:32.2138|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 204.4739ms 200 text/html; charset=utf-8 
2018-04-10 23:30:37.6449|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:30:37.6892|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:30:37.8139|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:30:37.8695|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:30:38.0144|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:30:38.0819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:30:38.1085|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:30:38.1416|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:30:38.1750|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:30:38.3444|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 601.0393ms 200 application/json; charset=UTF-8 
2018-04-10 23:30:38.4127|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=d3942a0875044a4e825c6d0a0984414a&nonce=290764f4b3014acfbb41a78c2faac667   
2018-04-10 23:30:38.4829|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:30:38.7382|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:30:38.7738|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:30:38.8158|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:30:38.8632|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|No user present in authorize request 
2018-04-10 23:30:38.9107|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:30:38.9484|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:30:38.9814|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Nonce": "290764f4b3014acfbb41a78c2faac667",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "d3942a0875044a4e825c6d0a0984414a",
    "nonce": "290764f4b3014acfbb41a78c2faac667"
  }
} 
2018-04-10 23:30:39.0361|0|IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator|INFO|Showing login: User is not authenticated 
2018-04-10 23:30:39.0824|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 759.0986ms 302  
2018-04-10 23:30:39.1260|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/account/login?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dclient_id%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A5200%252Flogin-callback%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520email%2520client_name%26state%3Dd3942a0875044a4e825c6d0a0984414a%26nonce%3D290764f4b3014acfbb41a78c2faac667   
2018-04-10 23:30:39.2345|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments (/connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=d3942a0875044a4e825c6d0a0984414a&nonce=290764f4b3014acfbb41a78c2faac667) - ModelState is Valid 
2018-04-10 23:30:39.3121|11|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.External signed out. 
2018-04-10 23:30:42.1512|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Account/Login.cshtml. 
2018-04-10 23:30:45.1886|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 5760.0311ms 
2018-04-10 23:30:45.4173|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 6105.9524ms 200 text/html; charset=utf-8 
2018-04-10 23:31:05.6360|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 POST http://localhost:5000/Account/Login?returnurl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dclient_id%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A5200%252Flogin-callback%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520email%2520client_name%26state%3Dd3942a0875044a4e825c6d0a0984414a%26nonce%3D290764f4b3014acfbb41a78c2faac667 application/x-www-form-urlencoded 232 
2018-04-10 23:31:05.7103|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) with arguments (KiraNet.Camellia.AuthorizationServer.Models.ViewModels.LoginViewModel, /connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=d3942a0875044a4e825c6d0a0984414a&nonce=290764f4b3014acfbb41a78c2faac667) - ModelState is Valid 
2018-04-10 23:31:05.8021|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:31:05.9073|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (39ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Alias], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0 
2018-04-10 23:31:06.1377|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:06.2032|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (22ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:06.2739|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:06.3242|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (10ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:06.3897|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:31:06.4434|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding idp claim with value: local 
2018-04-10 23:31:06.4800|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding amr claim with value: pwd 
2018-04-10 23:31:06.5216|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Adding auth_time claim with value: 1523374266 
2018-04-10 23:31:06.5730|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:31:06.6222|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|User logged in. 
2018-04-10 23:31:06.6936|1|Microsoft.AspNetCore.Mvc.Internal.RedirectResultExecutor|INFO|Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=d3942a0875044a4e825c6d0a0984414a&nonce=290764f4b3014acfbb41a78c2faac667. 
2018-04-10 23:31:06.7482|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.AccountController.Login (KiraNet.Camellia.AuthorizationServer) in 1033.1469ms 
2018-04-10 23:31:06.7993|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1138.3649ms 302  
2018-04-10 23:31:06.8607|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize/callback?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=d3942a0875044a4e825c6d0a0984414a&nonce=290764f4b3014acfbb41a78c2faac667   
2018-04-10 23:31:06.9107|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:06.9421|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:06.9751|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize/callback matched to endpoint type Authorize 
2018-04-10 23:31:07.0105|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint 
2018-04-10 23:31:07.0492|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback 
2018-04-10 23:31:07.1144|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|Start authorize callback request 
2018-04-10 23:31:07.1692|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:31:07.2050|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:31:07.2396|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:31:07.2846|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Nonce": "290764f4b3014acfbb41a78c2faac667",
  "SessionId": "e49b91c992d93100f01f139dfdc23bc6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "d3942a0875044a4e825c6d0a0984414a",
    "nonce": "290764f4b3014acfbb41a78c2faac667"
  }
} 
2018-04-10 23:31:07.3469|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:31:07.4052|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (16ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:31:07.4586|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:31:07.5356|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:31:07.5862|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:31:07.6481|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:31:07.6832|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:31:07.7230|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:31:07.7601|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:31:07.8190|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:07.8714|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (22ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:07.9248|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:07.9778|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:08.0330|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:31:08.0870|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:08.1209|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:08.1658|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:08.2080|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (13ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:08.2538|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:31:08.3206|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|Augmenting SignInContext 
2018-04-10 23:31:08.3581|10|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application signed in. 
2018-04-10 23:31:08.4055|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1550.8792ms 302  
2018-04-10 23:31:29.7434|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:31:29.8074|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:31:29.9121|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:31:29.9459|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:31:29.9790|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:31:30.0104|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:31:30.0361|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:31:30.0704|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:31:30.1241|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:31:30.9282|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 464.139ms 200 application/json; charset=UTF-8 
2018-04-10 23:31:31.0020|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200%2Flogin-callback&response_type=id_token%20token&scope=openid%20profile%20email%20client_name&state=a085514291ed4d4fbd2b0a8b84b9a096&nonce=7e1606f06ac14ff395f3a57358fef162   
2018-04-10 23:31:31.0776|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:31.1052|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:31.1593|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:31:31.1862|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:31:31.2172|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:31:31.2504|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:31:31.2834|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:31:31.3141|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:31:31.3462|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator 
2018-04-10 23:31:31.3804|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "a085514291ed4d4fbd2b0a8b84b9a096",
  "Nonce": "7e1606f06ac14ff395f3a57358fef162",
  "SessionId": "e49b91c992d93100f01f139dfdc23bc6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "a085514291ed4d4fbd2b0a8b84b9a096",
    "nonce": "7e1606f06ac14ff395f3a57358fef162"
  }
} 
2018-04-10 23:31:31.4291|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:31:31.4825|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (21ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:31:31.5463|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=KiraNet.Camellia.AuthorizationServer  
2018-04-10 23:31:31.5929|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (4ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Key] = @__key_0 
2018-04-10 23:31:31.6568|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True 
2018-04-10 23:31:31.7754|0|IdentityServer4.Services.DefaultConsentService|DEBUG|Consent found in consent store is same as current request, consent is not required 
2018-04-10 23:31:31.8617|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|Creating Implicit Flow response. 
2018-04-10 23:31:31.9800|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for client: client_id 
2018-04-10 23:31:32.2624|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:31:32.4534|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (67ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:32.5358|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (36ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:32.5960|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (9ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:32.6831|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (39ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:32.7676|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id 
2018-04-10 23:31:32.8417|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:32.9113|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:32.9703|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:33.0183|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (14ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:33.0752|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "a085514291ed4d4fbd2b0a8b84b9a096",
  "Scope": "openid profile email client_name"
} 
2018-04-10 23:31:33.1399|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 2392.8151ms 302  
2018-04-10 23:31:38.2269|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:31:38.2834|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 
2018-04-10 23:31:38.3984|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:31:38.4393|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:31:38.4723|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:31:38.5055|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:31:38.5379|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:31:38.6831|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:31:39.0106|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:31:39.0867|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 814.1206ms 200 application/json; charset=UTF-8 
2018-04-10 23:31:39.1284|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:31:39.1619|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 
2018-04-10 23:31:39.1983|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:31:39.2326|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:31:39.2681|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:31:39.3007|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:31:39.3505|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:31:39.3863|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:31:39.4205|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:31:39.5267|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 322.1784ms 200 application/json; charset=UTF-8 
2018-04-10 23:31:39.8258|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 OPTIONS http://localhost:5000/connect/userinfo   
2018-04-10 23:31:39.8709|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:31:39.9068|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:31:39.9606|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:31:40.0472|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:31:40.1483|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 367.0396ms 204  
2018-04-10 23:31:40.3635|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/userinfo   
2018-04-10 23:31:40.5930|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CORS request made for path: /connect/userinfo from origin: http://localhost:5200 
2018-04-10 23:31:40.6423|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|Client list checked and origin: http://localhost:5200 is allowed 
2018-04-10 23:31:40.6821|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|CorsPolicyService allowed origin: http://localhost:5200 
2018-04-10 23:31:40.7113|4|Microsoft.AspNetCore.Cors.Infrastructure.CorsService|INFO|Policy execution successful. 
2018-04-10 23:31:40.7343|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/userinfo matched to endpoint type Userinfo 
2018-04-10 23:31:40.7608|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint 
2018-04-10 23:31:40.7899|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo 
2018-04-10 23:31:40.8213|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|Start userinfo request 
2018-04-10 23:31:40.8472|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|Bearer token found in header 
2018-04-10 23:31:40.8780|10403|Microsoft.EntityFrameworkCore.Infrastructure|INFO|Entity Framework Core 2.0.2-rtm-10011 initialized 'AuthDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None 
2018-04-10 23:31:40.9342|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (3ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[Alias], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [Users] AS [e]
WHERE [e].[Id] = @__get_Item_0 
2018-04-10 23:31:41.0013|0|IdentityServer4.Validation.TokenValidator|DEBUG|Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator 
2018-04-10 23:31:41.0589|0|IdentityServer4.Validation.TokenValidator|DEBUG|Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374292,
    "exp": 1523381492,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374266,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} 
2018-04-10 23:31:41.0960|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Creating userinfo response 
2018-04-10 23:31:41.1282|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:31:41.1662|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:31:41.1999|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified 
2018-04-10 23:31:41.2433|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|Scopes in access token: openid profile email client_name 
2018-04-10 23:31:41.2948|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [UserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0 
2018-04-10 23:31:41.3629|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (17ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [role].[Name]
FROM [UserRoles] AS [userRole]
INNER JOIN [Roles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0 
2018-04-10 23:31:41.4570|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (25ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[NormalizedName] = @__normalizedName_0 
2018-04-10 23:31:41.5135|20101|Microsoft.EntityFrameworkCore.Database.Command|INFO|Executed DbCommand (19ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [rc].[ClaimType], [rc].[ClaimValue]
FROM [RoleClaims] AS [rc]
WHERE [rc].[RoleId] = @__role_Id_0 
2018-04-10 23:31:41.5490|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|Profile service returned to the following claim types: sub preferred_username name email email_verified 
2018-04-10 23:31:41.5946|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|End userinfo request 
2018-04-10 23:31:41.8577|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 1433.851ms 200 application/json; charset=UTF-8 
2018-04-10 23:31:42.0395|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/checksession   
2018-04-10 23:31:42.1055|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:42.1589|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:42.2013|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/checksession matched to endpoint type Checksession 
2018-04-10 23:31:42.2454|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint 
2018-04-10 23:31:42.2898|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession 
2018-04-10 23:31:42.3389|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|Rendering check session result 
2018-04-10 23:31:42.3939|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 433.0324ms 200 text/html; charset=UTF-8 
2018-04-10 23:31:44.7090|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/connect/authorize?client_id=client_id&redirect_uri=http%3A%2F%2Flocalhost%3A5200&response_type=id_token&scope=openid&state=6f1bc975394c4277a42fd0819ff72e63&nonce=6a96929c180f4cda8258eb7e026bed59&prompt=none   
2018-04-10 23:31:44.7494|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:44.7825|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:44.8167|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /connect/authorize matched to endpoint type Authorize 
2018-04-10 23:31:44.8502|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint 
2018-04-10 23:31:44.8900|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize 
2018-04-10 23:31:44.9214|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|Start authorize request 
2018-04-10 23:31:44.9473|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 
2018-04-10 23:31:44.9730|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|Start authorize request protocol validation 
2018-04-10 23:31:45.0024|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "6f1bc975394c4277a42fd0819ff72e63",
    "nonce": "6a96929c180f4cda8258eb7e026bed59",
    "prompt": "none"
  }
} 
2018-04-10 23:31:45.0321|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|Request validation failed 
2018-04-10 23:31:45.0682|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "6f1bc975394c4277a42fd0819ff72e63",
    "nonce": "6a96929c180f4cda8258eb7e026bed59",
    "prompt": "none"
  }
} 
2018-04-10 23:31:45.1242|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 406.6212ms 302  
2018-04-10 23:31:45.1788|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/home/error?errorId=CfDJ8BC_M7YetWVIrJcwI8SRrsq8-dh_P8mOKYFbDg00rOPbZ4OxFSvtk7_1WsaRYThNzhrRqjddkWmE4kS4EtUGU9_KtDY4Qi8upVsc6EGZLSsMlI8m-hbFKeA59HrjZ7Ejx6b4RaFyp7njTKcyPhp9XG5F2kCVGBl5cN9s4kyhZAokVzTPJCf-rJcV566gtU2woxPsQ3SN02N-sRNCzc0mAvQLwkIaCckqP_27mNJj3QjdfX2ZQNOpOcPd_qzB1jhXCGW17WxkMv1drmVSp0MyB7eKtRawRaaypu2nk1YPX3tY-8WaM5dOE33-lUcP21wbbQ   
2018-04-10 23:31:45.2267|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:45.3095|8|Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler|INFO|AuthenticationScheme: Identity.Application was successfully authenticated. 
2018-04-10 23:31:45.4128|1|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executing action method KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) with arguments (CfDJ8BC_M7YetWVIrJcwI8SRrsq8-dh_P8mOKYFbDg00rOPbZ4OxFSvtk7_1WsaRYThNzhrRqjddkWmE4kS4EtUGU9_KtDY4Qi8upVsc6EGZLSsMlI8m-hbFKeA59HrjZ7Ejx6b4RaFyp7njTKcyPhp9XG5F2kCVGBl5cN9s4kyhZAokVzTPJCf-rJcV566gtU2woxPsQ3SN02N-sRNCzc0mAvQLwkIaCckqP_27mNJj3QjdfX2ZQNOpOcPd_qzB1jhXCGW17WxkMv1drmVSp0MyB7eKtRawRaaypu2nk1YPX3tY-8WaM5dOE33-lUcP21wbbQ) - ModelState is Valid 
2018-04-10 23:31:45.4902|1|Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor|INFO|Executing ViewResult, running view at path /Views/Home/Error.cshtml. 
2018-04-10 23:31:45.7374|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/bootstrap/dist/css/bootstrap.css   
2018-04-10 23:31:45.7578|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/tether/dist/js/tether.js   
2018-04-10 23:31:45.7877|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/css/site.css   
2018-04-10 23:31:45.8370|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery/dist/jquery.js   
2018-04-10 23:31:45.9149|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/bootstrap/dist/js/bootstrap.js   
2018-04-10 23:31:45.9376|2|Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker|INFO|Executed action KiraNet.Camellia.AuthorizationServer.Controllers.HomeController.Error (KiraNet.Camellia.AuthorizationServer) in 188.1545ms 
2018-04-10 23:31:45.9648|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.css'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\bootstrap\dist\css\bootstrap.css' 
2018-04-10 23:31:45.9550|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/css/site.css'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\css\site.css' 
2018-04-10 23:31:45.9810|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/jquery/dist/jquery.js'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\jquery\dist\jquery.js' 
2018-04-10 23:31:45.9376|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/tether/dist/js/tether.js'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\tether\dist\js\tether.js' 
2018-04-10 23:31:46.0385|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.js'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\bootstrap\dist\js\bootstrap.js' 
2018-04-10 23:31:46.2289|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 441.7087ms 200 text/css 
2018-04-10 23:31:46.3878|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 606.4645ms 200 application/javascript 
2018-04-10 23:31:46.5999|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 691.9026ms 200 application/javascript 
2018-04-10 23:31:46.6184|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 756.7115ms 200 application/javascript 
2018-04-10 23:31:46.6411|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 709.7117ms 200 text/css 
2018-04-10 23:31:46.7115|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 821.1115ms 200 text/html; charset=utf-8 
2018-04-10 23:31:46.7412|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/bootstrap/dist/css/bootstrap.css.map   
2018-04-10 23:31:46.7556|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/lib/bootstrap/dist/js/bootstrap.js.map   
2018-04-10 23:31:46.8033|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.js.map'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\bootstrap\dist\js\bootstrap.js.map' 
2018-04-10 23:31:46.8426|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.css.map'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\lib\bootstrap\dist\css\bootstrap.css.map' 
2018-04-10 23:31:47.0100|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA   
2018-04-10 23:31:47.0740|2|Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware|INFO|Sending file. Request path: '/js/site.js'. Physical path: 'C:\monster\Code\KiraNet\KiraNet.Camellia\src\KiraNet.Camellia\Server\KiraNet.Camellia.AuthorizationServer\wwwroot\js\site.js' 
2018-04-10 23:31:47.1395|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 335.4287ms 200 text/plain 
2018-04-10 23:31:47.1559|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 303.9667ms 200 text/plain 
2018-04-10 23:31:47.2149|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 287.6104ms 200 application/javascript 
2018-04-10 23:31:48.4983|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration   
2018-04-10 23:31:48.5371|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration matched to endpoint type Discovery 
2018-04-10 23:31:48.5809|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint 
2018-04-10 23:31:48.6125|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration 
2018-04-10 23:31:48.6540|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|Start discovery request 
2018-04-10 23:31:48.6907|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 188.7174ms 200 application/json; charset=UTF-8 
2018-04-10 23:31:49.0123|1|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request starting HTTP/1.1 GET http://localhost:5000/.well-known/openid-configuration/jwks   
2018-04-10 23:31:49.0373|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery 
2018-04-10 23:31:49.0656|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint 
2018-04-10 23:31:49.0923|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks 
2018-04-10 23:31:49.1237|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|Start key discovery request 
2018-04-10 23:31:49.1535|2|Microsoft.AspNetCore.Hosting.Internal.WebHost|INFO|Request finished in 134.9011ms 200 application/json; charset=UTF-8 
