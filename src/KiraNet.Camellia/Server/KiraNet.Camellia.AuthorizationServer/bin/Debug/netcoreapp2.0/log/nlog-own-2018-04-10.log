2018-04-10 23:04:15.5102|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:04:16.4529|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:04:17.4281|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:04:17.9590|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:04:18.1760|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:04:22.3464|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:06:30.7683|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/Account/Login|action: Login
2018-04-10 23:06:30.8366|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding idp claim with value: local |url: http://localhost/Account/Login|action: Login
2018-04-10 23:06:30.8836|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding amr claim with value: pwd |url: http://localhost/Account/Login|action: Login
2018-04-10 23:06:30.9373|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding auth_time claim with value: 1523372790 |url: http://localhost/Account/Login|action: Login
2018-04-10 23:06:31.0913|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|  User logged in. |url: http://localhost/Account/Login|action: Login
2018-04-10 23:07:08.0391|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.1513|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.1805|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.2627|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.3217|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.3586|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:08.4096|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:09.8982|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:09.9530|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:09.9983|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:10.0981|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:10.2414|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:10.3036|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:10.6093|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:10.8668|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "de27c44c77794a2996d02b667c878e5e",
  "Nonce": "e26aab102dcf4f069ccf224aef141325",
  "SessionId": "4f549fa725685341934f343c3b58a802",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "de27c44c77794a2996d02b667c878e5e",
    "nonce": "e26aab102dcf4f069ccf224aef141325"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:11.7400|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:12.0165|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:12.1222|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:12.2377|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:12.3082|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:13.2977|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:13.6128|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "de27c44c77794a2996d02b667c878e5e",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:13.7529|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:18.4209|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.4610|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.4930|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.5503|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.5858|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.6161|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.6518|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:07:18.8714|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:18.9150|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:18.9673|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:19.0856|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:19.1299|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:19.1731|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:19.3823|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:07:19.6506|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:19.6790|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:19.7091|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:19.8534|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:19.8825|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:19.9159|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.0276|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/userinfo matched to endpoint type Userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.0850|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.1311|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.2192|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  Start userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.2820|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|  Bearer token found in header |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.8117|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:20.9627|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523372832,
    "exp": 1523380032,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523372790,
    "idp": "local",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.0416|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Creating userinfo response |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.0962|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.2010|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.2688|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.3020|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.5016|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|  Profile service returned to the following claim types: sub preferred_username name email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.5314|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  End userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:07:21.8182|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:07:21.8791|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:07:21.9215|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:07:21.9655|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:07:24.1955|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.2209|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.2485|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.2867|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.3538|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.4158|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.4630|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "72cd9102487640b9906b4c09dbc40d07",
    "nonce": "80a8bfa6a19a4b5485eca924c3645204",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.5485|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:07:24.5975|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "72cd9102487640b9906b4c09dbc40d07",
    "nonce": "80a8bfa6a19a4b5485eca924c3645204",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:08:00.2778|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:08:00.3753|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:08:00.4552|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:08:00.5274|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:08:01.1215|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:08:01.1938|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:08:01.2319|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:08:01.2610|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:15:12.6489|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:15:12.8255|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:15:12.8720|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:15:12.8926|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:15:12.9126|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:15:13.5144|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:15:24.9819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:15:25.1405|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:15:25.2215|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:15:25.2744|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:15:27.1097|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:15:27.1518|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:15:27.2304|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:15:27.2997|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:18:29.0555|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:18:29.2412|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:18:29.2938|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:18:29.3652|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:18:29.4160|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:18:30.1173|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:18:45.6404|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:18:45.6984|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:18:45.7234|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:18:45.7571|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:18:46.7155|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:18:46.7467|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:18:46.7728|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:18:46.8293|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:20:59.7361|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:20:59.8971|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:20:59.9330|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:20:59.9647|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:20:59.9992|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:21:00.8094|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:21:05.8790|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|  User logged out. |url: http://localhost/Account/Logout|action: Logout
2018-04-10 23:21:21.8019|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/endsession/callback matched to endpoint type Endsession |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.3185|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.3544|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.4098|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  Processing signout callback request |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.6733|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|  No client front-channel logout URLs |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.7105|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|  No client back-channel logout URLs |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:22.8225|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|INFO|  Successful signout callback. |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:23.2263|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  No client front-channel iframe urls |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:23.4872|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  No client back-channel iframe urls |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:21:25.8943|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:25.9670|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:26.0313|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:26.2459|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:26.3165|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:26.3540|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:26.8749|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:27.4552|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:21:27.5024|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:21:27.5430|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:21:27.6040|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:21:29.9417|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:29.9768|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.0046|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.0454|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.0887|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.1348|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.2391|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "8d679087ce0d4380ae6c2651a39f9221",
    "nonce": "d41f2ed780684388ac7cd111e291522f",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.2840|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:30.4228|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "8d679087ce0d4380ae6c2651a39f9221",
    "nonce": "d41f2ed780684388ac7cd111e291522f",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:35.2538|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:35.2823|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:35.3273|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:35.3669|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:35.7562|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:21:35.7832|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:21:35.8066|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:21:35.8402|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:21:49.6175|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:49.6797|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:49.7295|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:49.9691|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:49.9999|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:50.0452|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:50.1132|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:21:50.8782|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:50.9268|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.1291|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.2517|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.3211|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.5568|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.7508|0|IdentityServer4.Validation.ScopeValidator|ERROR|  Invalid scope: role |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:51.8516|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:21:52.0717|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "4918a5841144453b99a8dcede13cb41a",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "4918a5841144453b99a8dcede13cb41a",
    "nonce": "3da03f030ff048c2b67091a30e202453"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:40.1200|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:23:40.3401|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:23:40.3752|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:23:40.4156|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:23:40.4463|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:23:41.0260|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:23:47.3353|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:47.4230|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:47.4878|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:47.5671|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:47.7109|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:47.7649|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:48.0469|0|IdentityServer4.Validation.ScopeValidator|ERROR|  Invalid scope: role |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:48.1356|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:23:49.3037|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "36bbadd9c5dd40c9aabcd397073e76ce",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "36bbadd9c5dd40c9aabcd397073e76ce",
    "nonce": "2c165f285f0a4067873fe54bd878d573"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:22.7683|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:24.0789|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:24.5474|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:25.5250|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:25.6095|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:26.0924|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:26.2462|0|IdentityServer4.Validation.ScopeValidator|ERROR|  Invalid scope: role |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:26.3118|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:25:26.4085|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "a614552f93664ec499c7c0b7c6c3afd8",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "a614552f93664ec499c7c0b7c6c3afd8",
    "nonce": "a40f4df7cdc04c8fae85360b6a223d80"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:26:39.8670|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:26:40.1064|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:26:40.1401|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:26:40.1621|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:26:40.1848|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:26:40.6805|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:26:58.1305|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:26:58.5912|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:26:58.6400|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:26:59.2320|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:01.6754|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:01.8230|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:02.2876|0|IdentityServer4.Validation.ScopeValidator|ERROR|  Invalid scope: role |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:02.3826|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:03.5113|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email role client_name",
  "State": "8a02ab11d833424293040357bd6f00d6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email role client_name",
    "state": "8a02ab11d833424293040357bd6f00d6",
    "nonce": "d680ca7c93314ec6b81560b75500f6c7"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:25.2022|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.3957|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.4541|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.5290|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.6079|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.7428|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:25.8119|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:27.0420|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.1387|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.1850|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.2421|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.3200|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.3691|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.4958|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.5473|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Nonce": "76199f280cf64977a5708c7b429646c6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "3e2a930792d8469ebed9fd86af3043da",
    "nonce": "76199f280cf64977a5708c7b429646c6"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:27.6932|0|IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator|INFO|  Showing login: User is not authenticated |url: http://localhost/connect/authorize|action: 
2018-04-10 23:27:45.2644|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/Account/Login|action: Login
2018-04-10 23:27:45.3032|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding idp claim with value: local |url: http://localhost/Account/Login|action: Login
2018-04-10 23:27:45.3357|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding amr claim with value: pwd |url: http://localhost/Account/Login|action: Login
2018-04-10 23:27:45.3759|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding auth_time claim with value: 1523374065 |url: http://localhost/Account/Login|action: Login
2018-04-10 23:27:45.5852|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|  User logged in. |url: http://localhost/Account/Login|action: Login
2018-04-10 23:27:46.2449|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize/callback matched to endpoint type Authorize |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.2892|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.3341|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.4155|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|  Start authorize callback request |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.4749|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.5305|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.5848|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:46.6414|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Nonce": "76199f280cf64977a5708c7b429646c6",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "3e2a930792d8469ebed9fd86af3043da",
    "nonce": "76199f280cf64977a5708c7b429646c6"
  }
} |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:47.4428|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:47.5658|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:47.6520|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:47.7380|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:47.7767|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:48.6710|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:49.1033|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "3e2a930792d8469ebed9fd86af3043da",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:49.2383|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:27:55.8224|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:55.8571|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:55.8933|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:55.9700|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:56.0038|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:56.0601|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:56.0938|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:27:56.2607|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.2984|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.3320|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.5192|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.5800|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.6219|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:56.6679|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:27:57.2220|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:57.3018|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:57.3576|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:57.5881|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:57.6738|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:57.7218|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:58.0697|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/userinfo matched to endpoint type Userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:58.2570|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:58.3153|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:58.3813|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  Start userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:58.4657|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|  Bearer token found in header |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.1069|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.1723|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374068,
    "exp": 1523381268,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.2362|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Creating userinfo response |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.3127|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.3901|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.5034|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.5579|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.9036|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|  Profile service returned to the following claim types: sub preferred_username name email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:27:59.9398|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  End userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:28:00.6135|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:28:00.6655|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:28:00.7135|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:28:00.7560|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:28:03.1561|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.1819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.2073|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.2365|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.2633|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.2881|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.3216|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "b15c883e32f24622aefe5ee74b9194b4",
    "nonce": "dd73e4e87f2240e9b6e09cd599f125e6",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.3552|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:03.3914|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "b15c883e32f24622aefe5ee74b9194b4",
    "nonce": "dd73e4e87f2240e9b6e09cd599f125e6",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:28:10.1425|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:28:10.1852|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:28:10.2230|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:28:10.3094|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:28:10.6871|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:28:10.7343|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:28:10.7733|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:28:10.8108|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:22.3404|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for authentication |url: |action: 
2018-04-10 23:29:22.4819|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-in |url: |action: 
2018-04-10 23:29:22.5127|0|IdentityServer4.Startup|DEBUG|  Using Identity.External as default scheme for sign-out |url: |action: 
2018-04-10 23:29:22.5397|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for challenge |url: |action: 
2018-04-10 23:29:22.5604|0|IdentityServer4.Startup|DEBUG|  Using Identity.Application as default scheme for forbid |url: |action: 
2018-04-10 23:29:23.6158|0|IdentityServer4.EntityFramework.TokenCleanup|DEBUG|  Starting token cleanup |url: |action: 
2018-04-10 23:29:25.5033|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.5436|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.5689|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.6477|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.6941|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.7290|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:25.7847|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:27.0295|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.0836|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.1167|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.1825|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.2675|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.3143|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.5838|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:27.9131|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "6c147f71c1fb423db6a8c61c4ee07e23",
  "Nonce": "67e830ae02d3432c9383ab67a8537233",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "6c147f71c1fb423db6a8c61c4ee07e23",
    "nonce": "67e830ae02d3432c9383ab67a8537233"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:28.7808|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:29.0267|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:29.0907|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:29.1694|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:29.2025|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:30.7969|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:31.0680|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "6c147f71c1fb423db6a8c61c4ee07e23",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:37.3347|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:37.4031|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:37.6670|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:37.8858|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:38.1622|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:38.2335|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:38.3000|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:38.5777|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.6378|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.6665|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.7404|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.8351|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.8801|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:38.9851|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:29:39.9002|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:39.9690|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.0703|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.3628|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.3965|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.4256|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.4956|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/userinfo matched to endpoint type Userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.5432|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.5731|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.7704|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  Start userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:40.8263|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|  Bearer token found in header |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.2905|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.3587|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374170,
    "exp": 1523381370,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.4327|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Creating userinfo response |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.4799|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.5188|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.5591|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.5882|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.8083|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|  Profile service returned to the following claim types: sub preferred_username name email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:41.8449|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  End userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:29:42.6347|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:29:42.8663|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:29:42.8906|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:29:42.9286|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:29:45.4604|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.5263|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.6025|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.7869|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.8275|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.8548|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.8939|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "d34ac22b269e487996e241aa6652cafa",
    "nonce": "276b912745984eb2ae752eb87b02db0c",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.9392|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:45.9742|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "d34ac22b269e487996e241aa6652cafa",
    "nonce": "276b912745984eb2ae752eb87b02db0c",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:53.5853|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:53.6312|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:53.6786|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:53.7763|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:53.9272|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:54.1721|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:54.2683|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:29:55.2035|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:55.8239|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.3278|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.3884|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.4733|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.5170|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.5568|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.5930|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.6684|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.6844|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:56.7286|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "93cf542f648b49f2839c4ca7b66d5ed5",
  "Nonce": "a485d8a81fb64cf98961e3e990743d1e",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "93cf542f648b49f2839c4ca7b66d5ed5",
    "nonce": "a485d8a81fb64cf98961e3e990743d1e"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.0038|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.1757|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.2428|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.3031|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.3554|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "360e4b47eaf245679d198aeb59817c2c",
  "Nonce": "53bf0fb35a754dc6b3f442021859735a",
  "SessionId": "58d3039bb32ebf36912f2b032752fa1d",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "360e4b47eaf245679d198aeb59817c2c",
    "nonce": "53bf0fb35a754dc6b3f442021859735a"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.7673|0|IdentityServer4.Hosting.IdentityServerMiddleware|FATAL|  Unhandled exception: The operation was canceled. The operation was canceled.|url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.8672|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:57.9522|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:58.0553|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:58.1745|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:58.2192|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:58.6078|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:29:59.4854|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "360e4b47eaf245679d198aeb59817c2c",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:05.9476|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:05.9923|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:06.1626|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:06.6747|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:06.8214|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:06.8857|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:06.9396|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:07.1887|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.2375|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.3047|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.4351|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.5430|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.6190|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:07.8679|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:30:08.2135|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.2375|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.2631|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.4914|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.5482|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.6482|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.7568|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/userinfo matched to endpoint type Userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.7915|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.8243|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.8552|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  Start userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:08.8875|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|  Bearer token found in header |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.0375|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.0758|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374198,
    "exp": 1523381398,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374065,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.1429|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Creating userinfo response |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.2104|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.3206|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.4046|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:09.4418|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:10.3524|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|  Profile service returned to the following claim types: sub preferred_username name email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:10.4466|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  End userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:30:11.2782|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:11.4943|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:11.5498|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:11.6188|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:15.2353|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|  User logged out. |url: http://localhost/Account/Logout|action: Logout
2018-04-10 23:30:17.0160|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/endsession/callback matched to endpoint type Endsession |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.1954|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.2404|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.3103|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  Processing signout callback request |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.3868|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|  No client front-channel logout URLs |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.4210|0|IdentityServer4.Validation.EndSessionRequestValidator|DEBUG|  No client back-channel logout URLs |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.4660|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|INFO|  Successful signout callback. |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.5232|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  No client front-channel iframe urls |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:17.5891|0|IdentityServer4.Endpoints.EndSessionCallbackEndpoint|DEBUG|  No client back-channel iframe urls |url: http://localhost/connect/endsession/callback|action: 
2018-04-10 23:30:28.1480|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.1908|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.2191|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.2977|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.3345|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.3713|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:28.4299|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:29.0294|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:29.1348|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:29.2768|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:29.3454|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:30:31.6410|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.6728|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.7079|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.7391|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.7695|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.7970|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.8281|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "19a8e4070de94baebf9d1fcf882017d2",
    "nonce": "02dcf6259c89411db2897a2b518d535a",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.8693|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:31.9128|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "19a8e4070de94baebf9d1fcf882017d2",
    "nonce": "02dcf6259c89411db2897a2b518d535a",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:37.6892|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:37.8139|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:37.8695|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:38.0819|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:38.1085|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:38.1416|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:38.1750|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:30:38.4829|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.7382|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.7738|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.8158|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.8632|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  No user present in authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.9107|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.9484|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:38.9814|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Nonce": "290764f4b3014acfbb41a78c2faac667",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "d3942a0875044a4e825c6d0a0984414a",
    "nonce": "290764f4b3014acfbb41a78c2faac667"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:30:39.0361|0|IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator|INFO|  Showing login: User is not authenticated |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:06.3897|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/Account/Login|action: Login
2018-04-10 23:31:06.4434|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding idp claim with value: local |url: http://localhost/Account/Login|action: Login
2018-04-10 23:31:06.4800|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding amr claim with value: pwd |url: http://localhost/Account/Login|action: Login
2018-04-10 23:31:06.5216|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Adding auth_time claim with value: 1523374266 |url: http://localhost/Account/Login|action: Login
2018-04-10 23:31:06.6222|0|KiraNet.Camellia.AuthorizationServer.Controllers.AccountController|INFO|  User logged in. |url: http://localhost/Account/Login|action: Login
2018-04-10 23:31:06.9751|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize/callback matched to endpoint type Authorize |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.0105|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.0492|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.1144|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|  Start authorize callback request |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.1692|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.2050|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.2396|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.2846|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Nonce": "290764f4b3014acfbb41a78c2faac667",
  "SessionId": "e49b91c992d93100f01f139dfdc23bc6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "d3942a0875044a4e825c6d0a0984414a",
    "nonce": "290764f4b3014acfbb41a78c2faac667"
  }
} |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.5862|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.6481|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.6832|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.7230|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:07.7601|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:08.0330|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:08.2538|0|IdentityServer4.Endpoints.AuthorizeCallbackEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "d3942a0875044a4e825c6d0a0984414a",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:08.3206|0|IdentityServer4.Hosting.IdentityServerAuthenticationService|DEBUG|  Augmenting SignInContext |url: http://localhost/connect/authorize/callback|action: 
2018-04-10 23:31:29.8074|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:29.9121|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:29.9459|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:30.0104|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:30.0361|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:30.0704|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:30.1241|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:31.1593|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.1862|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.2172|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.2504|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.2834|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.3141|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.3462|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.3804|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  ValidatedAuthorizeRequest
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "RedirectUri": "http://localhost:5200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email client_name",
  "State": "a085514291ed4d4fbd2b0a8b84b9a096",
  "Nonce": "7e1606f06ac14ff395f3a57358fef162",
  "SessionId": "e49b91c992d93100f01f139dfdc23bc6",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200/login-callback",
    "response_type": "id_token token",
    "scope": "openid profile email client_name",
    "state": "a085514291ed4d4fbd2b0a8b84b9a096",
    "nonce": "7e1606f06ac14ff395f3a57358fef162"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.6568|0|IdentityServer4.EntityFramework.Stores.PersistedGrantStore|DEBUG|  ziDYl0wVbeUB5GMXmKZHGhpoXs9bjRe8ti7zHtwfzlI= found in database: True |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.7754|0|IdentityServer4.Services.DefaultConsentService|DEBUG|  Consent found in consent store is same as current request, consent is not required |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.8617|0|IdentityServer4.ResponseHandling.AuthorizeResponseGenerator|DEBUG|  Creating Implicit Flow response. |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:31.9800|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:32.2624|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for access token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:32.7676|0|IdentityServer4.Services.DefaultClaimsService|DEBUG|  Getting claims for identity token for subject: 4b0bf01c-6fae-4ecc-9202-feada77ad388 and client: client_id |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:33.0752|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  Authorize endpoint response
{
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "ClientId": "client_id",
  "RedirectUri": "http://localhost:5200/login-callback",
  "State": "a085514291ed4d4fbd2b0a8b84b9a096",
  "Scope": "openid profile email client_name"
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:38.2834|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:38.3984|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:38.4393|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:38.5055|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:38.5379|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:38.6831|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:39.0106|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:39.1619|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.1983|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.2326|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.3007|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.3505|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.3863|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.4205|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:39.8709|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:39.9068|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:39.9606|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.5930|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CORS request made for path: /connect/userinfo from origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.6423|0|IdentityServer4.Services.InMemoryCorsPolicyService|DEBUG|  Client list checked and origin: http://localhost:5200 is allowed |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.6821|0|IdentityServer4.Hosting.CorsPolicyProvider|DEBUG|  CorsPolicyService allowed origin: http://localhost:5200 |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.7343|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/userinfo matched to endpoint type Userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.7608|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.7899|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.8213|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  Start userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:40.8472|0|IdentityServer4.Validation.BearerTokenUsageValidator|DEBUG|  Bearer token found in header |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.0013|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.0589|0|IdentityServer4.Validation.TokenValidator|DEBUG|  Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523374292,
    "exp": 1523381492,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "client_name"
    ],
    "client_id": "client_id",
    "sub": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
    "auth_time": 1523374266,
    "idp": "local",
    "role": "admin",
    "preferred_username": "admin",
    "name": "admin",
    "email": "997525106@qq.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "client_name"
    ],
    "amr": "pwd"
  }
} |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.0960|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Creating userinfo response |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.1282|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.1662|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.1999|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.2433|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|DEBUG|  Scopes in access token: openid profile email client_name |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.5490|0|IdentityServer4.ResponseHandling.UserInfoResponseGenerator|INFO|  Profile service returned to the following claim types: sub preferred_username name email email_verified |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:41.5946|0|IdentityServer4.Endpoints.UserInfoEndpoint|DEBUG|  End userinfo request |url: http://localhost/connect/userinfo|action: 
2018-04-10 23:31:42.2013|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/checksession matched to endpoint type Checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:31:42.2454|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint |url: http://localhost/connect/checksession|action: 
2018-04-10 23:31:42.2898|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession |url: http://localhost/connect/checksession|action: 
2018-04-10 23:31:42.3389|0|IdentityServer4.Endpoints.CheckSessionEndpoint|DEBUG|  Rendering check session result |url: http://localhost/connect/checksession|action: 
2018-04-10 23:31:44.8167|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /connect/authorize matched to endpoint type Authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:44.8502|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:44.8900|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:44.9214|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  Start authorize request |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:44.9473|0|IdentityServer4.Endpoints.AuthorizeEndpoint|DEBUG|  User in authorize request: 4b0bf01c-6fae-4ecc-9202-feada77ad388 |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:44.9730|0|IdentityServer4.Validation.AuthorizeRequestValidator|DEBUG|  Start authorize request protocol validation |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:45.0024|0|IdentityServer4.Validation.AuthorizeRequestValidator|ERROR|  Invalid redirect_uri: http://localhost:5200
{
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "6f1bc975394c4277a42fd0819ff72e63",
    "nonce": "6a96929c180f4cda8258eb7e026bed59",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:45.0321|0|IdentityServer4.Endpoints.AuthorizeEndpoint|ERROR|  Request validation failed |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:45.0682|0|IdentityServer4.Endpoints.AuthorizeEndpoint|INFO|  {
  "ClientId": "client_id",
  "ClientName": "client_name",
  "AllowedRedirectUris": [
    "http://localhost:5200/login-callback"
  ],
  "SubjectId": "4b0bf01c-6fae-4ecc-9202-feada77ad388",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client_id",
    "redirect_uri": "http://localhost:5200",
    "response_type": "id_token",
    "scope": "openid",
    "state": "6f1bc975394c4277a42fd0819ff72e63",
    "nonce": "6a96929c180f4cda8258eb7e026bed59",
    "prompt": "none"
  }
} |url: http://localhost/connect/authorize|action: 
2018-04-10 23:31:48.5371|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:48.5809|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:48.6125|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:48.6540|0|IdentityServer4.Endpoints.DiscoveryEndpoint|DEBUG|  Start discovery request |url: http://localhost/.well-known/openid-configuration|action: 
2018-04-10 23:31:49.0373|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:49.0656|0|IdentityServer4.Hosting.EndpointRouter|DEBUG|  Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:49.0923|0|IdentityServer4.Hosting.IdentityServerMiddleware|INFO|  Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks |url: http://localhost/.well-known/openid-configuration/jwks|action: 
2018-04-10 23:31:49.1237|0|IdentityServer4.Endpoints.DiscoveryKeyEndpoint|DEBUG|  Start key discovery request |url: http://localhost/.well-known/openid-configuration/jwks|action: 
